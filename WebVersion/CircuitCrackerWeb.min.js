Bridge.assembly("CircuitCrackerWeb",function($asm,globals){"use strict";Bridge.define("CircuitCracker.App",{main:function(){var canvas=document.createElement("canvas");canvas.width=1088;canvas.height=576;canvas.id="monogamecanvas";document.getElementById("game").appendChild(canvas);CircuitCracker.App.game=new CircuitCracker.Game;CircuitCracker.App.game.Run()},statics:{fields:{game:null}}});Bridge.define("CircuitCracker.Game",{inherits:[Microsoft.Xna.Framework.Game],statics:{fields:{world:null,settings:null,startMenu:null,paused:!1,TouchInput:!1,tickTime:0,exit:!1},ctors:{init:function(){this.world=new VelcroPhysics.Dynamics.World(Microsoft.Xna.Framework.Vector2.Zero.$clone());this.settings=new CircuitCracker.Settings;this.startMenu=new CircuitCracker.StartMenu;this.paused=!0;this.tickTime=.02}},methods:{Quit:function(){CircuitCracker.Game.exit=!0}}},fields:{graphics:null,spriteBatch:null,lastFixture:null,levelRenderer:null,levelManager:null,wireLogic:null,tilePlacer:null,timeSinceLastTick:0},ctors:{ctor:function(){this.$initialize();Microsoft.Xna.Framework.Game.ctor.call(this);this.Content.RootDirectory="Content";this.graphics=new Microsoft.Xna.Framework.GraphicsDeviceManager(this);this.wireLogic=new CircuitCracker.WireLogic;this.tilePlacer=new CircuitCracker.TilePlacer;this.graphics.IsFullScreen=!1;this.graphics.PreferredBackBufferWidth=1088;this.graphics.PreferredBackBufferHeight=576}},methods:{OnWindowChanged:function(sender,e){this.levelRenderer.Resize(this.Window.ClientBounds.Width,this.Window.ClientBounds.Height)},TouchUsed:function(sender,e){this.graphics.IsFullScreen||this.graphics.ToggleFullScreen();CircuitCracker.Game.TouchInput=!0},LoadContent:function(){this.Window.addClientSizeChanged(Bridge.fn.cacheBind(this,this.OnWindowChanged));this.Window.addOrientationChanged(Bridge.fn.cacheBind(this,this.OnWindowChanged));this.Window.addTouchInputUsed(Bridge.fn.cacheBind(this,this.TouchUsed));this.spriteBatch=new Microsoft.Xna.Framework.Graphics.SpriteBatch(this.GraphicsDevice);this.LoadStuff()},LoadStuff:function(){var $step=0,$task1,$jumpFromFinally,path,$asyncBody=Bridge.fn.bind(this,function(){for(;;){$step=System.Array.min([0,1],$step);switch($step){case 0:$task1=CircuitCracker.GameContent.Init(this.Content);$step=1;$task1.continueWith($asyncBody,!0);return;case 1:$task1.getAwaitedResult();CircuitCracker.UI.TextBox.fontSmall=CircuitCracker.GameContent.Font.fontSmall;CircuitCracker.UI.TextBox.fontBig=CircuitCracker.GameContent.Font.fontBig;CircuitCracker.UI.CommonUI.Init();this.levelRenderer=new CircuitCracker.LevelRenderer(this.GraphicsDevice,this.spriteBatch,CircuitCracker.GameContent.Texture.sprites,this.tilePlacer);this.levelManager=new CircuitCracker.LevelManager(this.wireLogic,this.tilePlacer,this.levelRenderer);CircuitCracker.Game.startMenu.Show();path="Levels/title screen.level";this.levelManager.LoadLevel(path,!1);return;default:return}}},arguments);$asyncBody()},Update:function(gameTime){var deltaTime,f,hoverExit,hoverEnter,clickable,hoverExit1;CircuitCracker.GameContent.IsLoaded&&(CircuitCracker.Game.exit&&this.Exit(),this.IsActive&&(deltaTime=gameTime.ElapsedGameTime.getTotalSeconds(),CircuitCracker.Input.Update(),CircuitCracker.Input.GetButtonDown$2(Microsoft.Xna.Framework.Input.Keys.R)&&this.levelManager.ResetLevel(),CircuitCracker.Input.GetButtonDown$2(Microsoft.Xna.Framework.Input.Keys.U)&&CircuitCracker.Stats.LoadStats(),CircuitCracker.Input.GetButtonDown$2(Microsoft.Xna.Framework.Input.Keys.F)&&this.graphics.ToggleFullScreen(),this.tilePlacer.MousePosValid||CircuitCracker.UI.UIElement.IsMouseOverUI()?this.lastFixture!=null&&(hoverExit1=Bridge.as(this.lastFixture.Body.UserData,CircuitCracker.LevelObjects.IHoverable))!=null&&(hoverExit1.CircuitCracker$LevelObjects$IHoverable$OnMouseExit(),this.lastFixture=null):(f=CircuitCracker.Game.world.TestPoint(CircuitCracker.LevelRenderer.MousePos()),Bridge.referenceEquals(f,this.lastFixture)||(this.lastFixture!=null&&(hoverExit=Bridge.as(this.lastFixture.Body.UserData,CircuitCracker.LevelObjects.IHoverable))!=null&&hoverExit.CircuitCracker$LevelObjects$IHoverable$OnMouseExit(),f!=null&&(hoverEnter=Bridge.as(f.Body.UserData,CircuitCracker.LevelObjects.IHoverable))!=null&&hoverEnter.CircuitCracker$LevelObjects$IHoverable$OnMouseEnter()),this.lastFixture=f,CircuitCracker.Input.GetButtonDown(CircuitCracker.MouseButton.Left)&&f!=null&&(clickable=Bridge.as(f.Body.UserData,CircuitCracker.LevelObjects.IClickable))!=null&&clickable.CircuitCracker$LevelObjects$IClickable$OnClick()),CircuitCracker.UI.UIElement.UpdateAll(deltaTime),CircuitCracker.UI.CommonUI.Update(deltaTime),this.tilePlacer.Update(gameTime.TotalGameTime.getTotalSeconds()),this.timeSinceLastTick+=deltaTime,CircuitCracker.Game.paused||(CircuitCracker.LevelObjects.Moveable.Update(),this.timeSinceLastTick+=deltaTime,this.timeSinceLastTick>=CircuitCracker.Game.tickTime&&(this.timeSinceLastTick-=CircuitCracker.Game.tickTime,CircuitCracker.Stats.AddTime(deltaTime),CircuitCracker.Game.world.Step(deltaTime),this.wireLogic.UpdateWires(),this.levelManager.UpdateObjects()))),Microsoft.Xna.Framework.Game.prototype.Update.call(this,gameTime))},Draw:function(gameTime){if(this.graphics.GraphicsDevice.Clear(Microsoft.Xna.Framework.Color.Black.$clone()),!CircuitCracker.GameContent.IsLoaded){if(CircuitCracker.GameContent.IsBaseLoaded){var counter=CircuitCracker.GameContent.Counter+" / "+CircuitCracker.GameContent.MaxCounter,percent=CircuitCracker.GameContent.Counter/21;this.spriteBatch.Begin();this.spriteBatch.DrawString(CircuitCracker.GameContent.Font.fontSmall,"Circuit Cracker is loading: "+(counter||""),new Microsoft.Xna.Framework.Vector2.$ctor2(20.5,506.5),Microsoft.Xna.Framework.Color.White.$clone());this.spriteBatch.Draw(CircuitCracker.GameContent.Texture.pixel,new Microsoft.Xna.Framework.Rectangle.$ctor2(20,536,Bridge.Int.clip32(1048*percent),20),Microsoft.Xna.Framework.Color.White.$clone());this.spriteBatch.End()}return}this.levelRenderer.DrawWalls();this.levelRenderer.DrawSprites();this.levelRenderer.DrawWires();this.levelRenderer.DrawOverlays(gameTime.TotalGameTime.getTotalSeconds());CircuitCracker.UI.UIElement.RenderAll(this.spriteBatch,CircuitCracker.GameContent.Texture.sprites,this.GraphicsDevice.Viewport.Bounds.$clone());Microsoft.Xna.Framework.Game.prototype.Draw.call(this,gameTime)}}});Bridge.define("CircuitCracker.GameContent",{statics:{fields:{IsBaseLoaded:!1,IsLoaded:!1,Counter:0,MaxCounter:0},ctors:{init:function(){this.MaxCounter=21}},methods:{Init:function(content){var $step=0,$task1,$taskResult1,$task2,$taskResult2,$task3,$taskResult3,$task4,$taskResult4,$task5,$taskResult5,$task6,$taskResult6,$task7,$taskResult7,$task8,$taskResult8,$task9,$taskResult9,$task10,$taskResult10,$task11,$taskResult11,$task12,$taskResult12,$task13,$taskResult13,$task14,$taskResult14,$task15,$taskResult15,$task16,$taskResult16,$task17,$taskResult17,$task18,$taskResult18,$task19,$taskResult19,$task20,$taskResult20,$task21,$taskResult21,$task22,$taskResult22,$task23,$taskResult23,$jumpFromFinally,$tcs=new System.Threading.Tasks.TaskCompletionSource,$returnValue,$async_e,$asyncBody=Bridge.fn.bind(this,function(){try{for(;;){$step=System.Array.min([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],$step);switch($step){case 0:CircuitCracker.GameContent.Counter=0;$task1=content.LoadAsync(Microsoft.Xna.Framework.Graphics.Texture2D,"Pixel");$step=1;$task1.continueWith($asyncBody);return;case 1:$taskResult1=$task1.getAwaitedResult();CircuitCracker.GameContent.Texture.pixel=$taskResult1;$task2=content.LoadAsync(Microsoft.Xna.Framework.Graphics.SpriteFont,"FontSmall");$step=2;$task2.continueWith($asyncBody);return;case 2:$taskResult2=$task2.getAwaitedResult();CircuitCracker.GameContent.Font.fontSmall=$taskResult2;CircuitCracker.GameContent.IsBaseLoaded=!0;$task3=content.LoadAsync(Microsoft.Xna.Framework.Graphics.Texture2D,"sprites");$step=3;$task3.continueWith($asyncBody);return;case 3:$taskResult3=$task3.getAwaitedResult();CircuitCracker.GameContent.Texture.sprites=$taskResult3;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task4=content.LoadAsync(Microsoft.Xna.Framework.Graphics.SpriteFont,"FontBig");$step=4;$task4.continueWith($asyncBody);return;case 4:$taskResult4=$task4.getAwaitedResult();CircuitCracker.GameContent.Font.fontBig=$taskResult4;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task5=content.LoadAsync(Microsoft.Xna.Framework.Graphics.Effect,"Inverse");$step=5;$task5.continueWith($asyncBody);return;case 5:$taskResult5=$task5.getAwaitedResult();CircuitCracker.GameContent.ShaderEffect.inverse=$taskResult5;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task6=content.LoadAsync(Microsoft.Xna.Framework.Graphics.Effect,"Dissolve");$step=6;$task6.continueWith($asyncBody);return;case 6:$taskResult6=$task6.getAwaitedResult();CircuitCracker.GameContent.ShaderEffect.dissolve=$taskResult6;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task7=content.LoadAsync(Microsoft.Xna.Framework.Graphics.Effect,"Materialize");$step=7;$task7.continueWith($asyncBody);return;case 7:$taskResult7=$task7.getAwaitedResult();CircuitCracker.GameContent.ShaderEffect.materialize=$taskResult7;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task8=content.LoadAsync(Microsoft.Xna.Framework.Graphics.Effect,"Teleport");$step=8;$task8.continueWith($asyncBody);return;case 8:$taskResult8=$task8.getAwaitedResult();CircuitCracker.GameContent.ShaderEffect.teleport=$taskResult8;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task9=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/conveyor.wav");$step=9;$task9.continueWith($asyncBody);return;case 9:$taskResult9=$task9.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.conveyor=$taskResult9;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task10=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/door_close.wav");$step=10;$task10.continueWith($asyncBody);return;case 10:$taskResult10=$task10.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.doorClose=$taskResult10;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task11=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/door_open.wav");$step=11;$task11.continueWith($asyncBody);return;case 11:$taskResult11=$task11.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.doorOpen=$taskResult11;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task12=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/laser.wav");$step=12;$task12.continueWith($asyncBody);return;case 12:$taskResult12=$task12.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.laser=$taskResult12;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task13=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/laser_on.wav");$step=13;$task13.continueWith($asyncBody);return;case 13:$taskResult13=$task13.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.laserOn=$taskResult13;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task14=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/piston.wav");$step=14;$task14.continueWith($asyncBody);return;case 14:$taskResult14=$task14.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.piston=$taskResult14;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task15=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/player_death.wav");$step=15;$task15.continueWith($asyncBody);return;case 15:$taskResult15=$task15.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.playerDeath=$taskResult15;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task16=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/pressure_plate.wav");$step=16;$task16.continueWith($asyncBody);return;case 16:$taskResult16=$task16.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.plate=$taskResult16;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task17=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/sensor.wav");$step=17;$task17.continueWith($asyncBody);return;case 17:$taskResult17=$task17.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.sensor=$taskResult17;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task18=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/spike.wav");$step=18;$task18.continueWith($asyncBody);return;case 18:$taskResult18=$task18.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.spike=$taskResult18;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task19=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/teleporter.wav");$step=19;$task19.continueWith($asyncBody);return;case 19:$taskResult19=$task19.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.teleporter=$taskResult19;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task20=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/win.wav");$step=20;$task20.continueWith($asyncBody);return;case 20:$taskResult20=$task20.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.win=$taskResult20;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task21=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/wooden_chest_death.wav");$step=21;$task21.continueWith($asyncBody);return;case 21:$taskResult21=$task21.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.crateDestroy=$taskResult21;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task22=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/reset.wav");$step=22;$task22.continueWith($asyncBody);return;case 22:$taskResult22=$task22.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.reset=$taskResult22;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;$task23=Microsoft.Xna.Framework.Audio.SoundEffect.FromURL("Content/sounds/message.wav");$step=23;$task23.continueWith($asyncBody);return;case 23:$taskResult23=$task23.getAwaitedResult();CircuitCracker.GameContent.SoundEffects.message=$taskResult23;CircuitCracker.GameContent.Counter=CircuitCracker.GameContent.Counter+1|0;CircuitCracker.GameContent.IsLoaded=!0;$tcs.setResult(null);return;default:$tcs.setResult(null);return}}}catch($async_e1){$async_e=System.Exception.create($async_e1);$tcs.setException($async_e)}},arguments);return $asyncBody(),$tcs.task}}}});Bridge.define("CircuitCracker.GameContent.Font",{$kind:"nested class",statics:{fields:{fontSmall:null,fontBig:null}}});Bridge.define("CircuitCracker.GameContent.ShaderEffect",{$kind:"nested class",statics:{fields:{inverse:null,dissolve:null,materialize:null,teleport:null}}});Bridge.define("CircuitCracker.GameContent.Songs",{$kind:"nested class"});Bridge.define("CircuitCracker.GameContent.SoundEffects",{$kind:"nested class",statics:{fields:{conveyor:null,doorClose:null,doorOpen:null,laser:null,laserOn:null,piston:null,playerDeath:null,plate:null,sensor:null,spike:null,teleporter:null,win:null,crateDestroy:null,reset:null,message:null}}});Bridge.define("CircuitCracker.GameContent.Texture",{$kind:"nested class",statics:{fields:{pixel:null,sprites:null}}});Bridge.define("CircuitCracker.Gate",{$kind:"enum",statics:{fields:{None:0,Not:1,And:2,Or:3,Xor:4,Toggle:5}}});Bridge.define("CircuitCracker.Input",{statics:{fields:{mouseState:null,mouseButtons:0,mouseButtonsPrevious:0,keyboardState:null,keyboardStatePrevious:null,gamePadState:null,gamePadStatePrevious:null},ctors:{init:function(){this.mouseState=new Microsoft.Xna.Framework.Input.MouseState;this.keyboardState=new Microsoft.Xna.Framework.Input.KeyboardState;this.keyboardStatePrevious=new Microsoft.Xna.Framework.Input.KeyboardState;this.gamePadState=new Microsoft.Xna.Framework.Input.GamePadState;this.gamePadStatePrevious=new Microsoft.Xna.Framework.Input.GamePadState}},methods:{Update:function(){CircuitCracker.Input.mouseButtonsPrevious=CircuitCracker.Input.mouseButtons;CircuitCracker.Input.keyboardStatePrevious=CircuitCracker.Input.keyboardState.$clone();CircuitCracker.Input.gamePadStatePrevious=CircuitCracker.Input.gamePadState.$clone();CircuitCracker.Input.mouseState=Microsoft.Xna.Framework.Input.Mouse.GetState();CircuitCracker.Input.keyboardState=Microsoft.Xna.Framework.Input.Keyboard.GetState();CircuitCracker.Input.gamePadState=Microsoft.Xna.Framework.Input.GamePad.GetState(Microsoft.Xna.Framework.PlayerIndex.One);CircuitCracker.Input.mouseButtons=CircuitCracker.MouseButton.None;CircuitCracker.Input.mouseState.LeftButton===Microsoft.Xna.Framework.Input.ButtonState.Pressed&&(CircuitCracker.Input.mouseButtons|=CircuitCracker.MouseButton.Left);CircuitCracker.Input.mouseState.MiddleButton===Microsoft.Xna.Framework.Input.ButtonState.Pressed&&(CircuitCracker.Input.mouseButtons|=CircuitCracker.MouseButton.Middle);CircuitCracker.Input.mouseState.RightButton===Microsoft.Xna.Framework.Input.ButtonState.Pressed&&(CircuitCracker.Input.mouseButtons|=CircuitCracker.MouseButton.Right)},GetMousePosition:function(){return CircuitCracker.Input.mouseState.Position.$clone()},GetMouseScroll:function(){return CircuitCracker.Input.mouseState.ScrollWheelValue},GetButton:function(button){return(CircuitCracker.Input.mouseButtons&button)===button},GetButton$2:function(key){return CircuitCracker.Input.keyboardState.IsKeyDown(key)},GetButton$1:function(button){return CircuitCracker.Input.gamePadState.IsButtonDown(button)},GetButtonDown:function(button){return(CircuitCracker.Input.mouseButtons&button)===button&&(CircuitCracker.Input.mouseButtonsPrevious&button)!==button},GetButtonDown$2:function(key){return CircuitCracker.Input.keyboardState.IsKeyDown(key)&&CircuitCracker.Input.keyboardStatePrevious.IsKeyUp(key)},GetButtonDown$1:function(button){return CircuitCracker.Input.gamePadState.IsButtonDown(button)&&CircuitCracker.Input.gamePadStatePrevious.IsButtonUp(button)},GetButtonUp:function(button){return(CircuitCracker.Input.mouseButtons&button)!==button&&(CircuitCracker.Input.mouseButtonsPrevious&button)===button},GetButtonUp$2:function(key){return CircuitCracker.Input.keyboardState.IsKeyUp(key)&&CircuitCracker.Input.keyboardStatePrevious.IsKeyDown(key)},GetButtonUp$1:function(button){return CircuitCracker.Input.gamePadState.IsButtonUp(button)&&CircuitCracker.Input.gamePadStatePrevious.IsButtonDown(button)}}}});Bridge.define("CircuitCracker.LevelObjects.IHoverable",{$kind:"interface"});Bridge.define("CircuitCracker.LevelObjects.IClickable",{$kind:"interface"});Bridge.define("CircuitCracker.LevelManager",{statics:{fields:{instance:null}},fields:{levelSize:null,levelMap:null,wireLogic:null,tilePlacer:null,levelRenderer:null,menuItems:null,currentLevel:null,levelObjects:null,previousLevels:null},ctors:{init:function(){this.levelSize=new Microsoft.Xna.Framework.Point;this.levelSize=new Microsoft.Xna.Framework.Point.$ctor2(32,16);this.previousLevels=new(System.Collections.Generic.List$1(System.String).ctor)},ctor:function(wireLogic,tilePlacer,levelRenderer){var rtp,i,x,y;for(this.$initialize(),rtp=null,this.wireLogic=wireLogic,this.tilePlacer=tilePlacer,this.levelRenderer=levelRenderer,this.levelMap=System.Array.create(null,null,CircuitCracker.LevelTile,this.levelSize.$clone().X,this.levelSize.$clone().Y),this.levelObjects=System.Array.init(CircuitCracker.TilePlacer.objectTypes.length,null,System.Collections.Generic.List$1(CircuitCracker.LevelObjects.LevelObject)),i=0;i<this.levelObjects.length;i=i+1|0)this.levelObjects[i]=new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.LevelObject).ctor);for(CircuitCracker.LevelManager.instance=this,rtp=Bridge.fn.bind(this,function(){this.RenderThumbnailPrevious(new Microsoft.Xna.Framework.Point.$ctor2(0,-1))}),this.menuItems=System.Array.init([new CircuitCracker.LevelButton(new Microsoft.Xna.Framework.Point.$ctor2(0,-1),CircuitCracker.Sprites.Back.$clone(),null,Bridge.fn.bind(this,function(){this.LoadPreviousLevel();rtp()}),rtp),new CircuitCracker.LevelButton(new Microsoft.Xna.Framework.Point.$ctor2(3,-1),CircuitCracker.Sprites.Reset.$clone(),"Reset (R)",Bridge.fn.cacheBind(this,this.ResetLevel)),new CircuitCracker.LevelButton(new Microsoft.Xna.Framework.Point.$ctor2(this.levelSize.$clone().X-4|0,-1),CircuitCracker.Sprites.Options.$clone(),"Settings",Bridge.fn.cacheBind(CircuitCracker.Game.settings,CircuitCracker.Game.settings.Show)),new CircuitCracker.LevelButton(new Microsoft.Xna.Framework.Point.$ctor2(this.levelSize.$clone().X-1|0,-1),CircuitCracker.Sprites.SaveGame.$clone(),"Save",CircuitCracker.Stats.SaveStats)],CircuitCracker.LevelButton),x=0;x<this.levelSize.$clone().X;x=x+1|0)for(y=0;y<this.levelSize.$clone().Y;y=y+1|0)this.levelMap.set([x,y],new CircuitCracker.LevelTile(x,y));this.InitLevel()}},methods:{AddToUpdateList:function(obj){this.levelObjects[obj.id].add(obj)},RemoveFromUpdateList:function(obj){this.levelObjects[obj.id].remove(obj)},ResetLevel:function(){var $t,$t1,tile,tile1;CircuitCracker.GameContent.SoundEffects.reset.Play();CircuitCracker.Stats.AddReset();this.wireLogic.ResetLogic();$t=Bridge.getEnumerator(this.levelMap);try{while($t.moveNext())tile=$t.Current,tile.obj!=null&&tile.obj.Reset()}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}CircuitCracker.Game.world.Step(0);$t1=Bridge.getEnumerator(this.levelMap);try{while($t1.moveNext())tile1=$t1.Current,tile1.obj!=null&&tile1.obj.Enable()}finally{Bridge.is($t1,System.IDisposable)&&$t1.System$IDisposable$Dispose()}},UpdateObjects:function(){for(var obj,$t,i=0;i<this.levelObjects.length;i=i+1|0){$t=Bridge.getEnumerator(this.levelObjects[i]);try{while($t.moveNext())obj=$t.Current,obj.enabled&&obj.FixedUpdate()}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}}},InitLevel:function(){this.tilePlacer.InitTilePlacer(this.levelMap,this.levelSize.$clone(),this.menuItems);this.levelRenderer.InitLevelRenderer(this.levelMap,this.levelSize.$clone());this.wireLogic.InitWireLogic(this.levelMap);this.menuItems[0].SetDisabled(!this.CanLoadPrevious());CircuitCracker.LevelObjects.LevelObject.completed=!1},CompleteLevel:function(){CircuitCracker.Stats.LevelCleared();CircuitCracker.UI.CommonUI.ShowTitle("Level Cleared",2,Bridge.fn.cacheBind(this,this.CompleteLevelAfter))},CompleteLevelAfter:function(){this.CanLoadPrevious()&&this.LoadPreviousLevel()},LoadLevel:function(path,fromLevel){var stream=new System.IO.FileStream.$ctor1(path,3),name;try{name=System.String.replaceAll(path,"Levels/","");name=System.String.replaceAll(name,".level","");this.LoadLevel$1(stream,name,fromLevel)}finally{Bridge.hasValue(stream)&&stream.System$IDisposable$Dispose()}},LoadLevel$1:function(level,levelname,fromLevel){CircuitCracker.Stats.ChangeLevel(levelname);fromLevel||this.previousLevels.clear();this.currentLevel=levelname;this.tilePlacer.ClearObjects();this.levelMap=this.GetLevelMap(level);this.InitLevel()},GetLevelMap:function(level){var $t,levelMap=System.Array.create(null,null,CircuitCracker.LevelTile,this.levelSize.$clone().X,this.levelSize.$clone().Y),reader=new System.IO.BinaryReader.ctor(level),x,y,t,combined;try{for(x=0;x<this.levelSize.$clone().X;x=x+1|0)for(y=0;y<this.levelSize.$clone().Y;y=y+1|0){if(t=($t=new CircuitCracker.LevelTile(x,y),$t.wire=reader.ReadUInt16(),$t.color=reader.ReadUInt16(),$t.objId=reader.ReadSByte(),$t),t.tmpWire=t.wire,combined=reader.ReadByte(),t.gate=combined>>2&15,t.wall=(combined&2)!=0,t.objFacing=combined>>6,(combined&1)!=0&&(t.objData=reader.ReadString()),t.gate!==CircuitCracker.Gate.None)switch(t.wire&15){case 1:t.gateFacing=0;break;case 2:t.gateFacing=1;break;case 4:t.gateFacing=2;break;case 8:t.gateFacing=3;break}levelMap.set([x,y],t)}}finally{Bridge.hasValue(reader)&&reader.System$IDisposable$Dispose()}return levelMap},ReloadLinkStates:function(){var $t,tile,link;$t=Bridge.getEnumerator(this.levelMap);try{while($t.moveNext())tile=$t.Current,(link=Bridge.as(tile.obj,CircuitCracker.LevelObjects.LevelLink))!=null&&(CircuitCracker.Stats.HasClearedLevel(tile.objData)?link.Complete():link.Lock())}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},RenderThumbnail:function(pos,levelname){var p=CircuitCracker.LevelRenderer.WorldToScreenPos(Microsoft.Xna.Framework.Vector2.op_Addition(pos.ToVector2(),new Microsoft.Xna.Framework.Vector2.$ctor2(-.5,.75))).ToPoint();CircuitCracker.UI.CommonUI.ShowTooltip(levelname,p.$clone())},RenderThumbnailPrevious:function(pos){this.CanLoadPrevious()&&this.RenderThumbnail(pos.$clone(),this.previousLevels.getItem(this.previousLevels.Count-1|0))},LinkLoadLevel:function(levelname){if(this.previousLevels.Count<=500){var path="Levels/"+(levelname||"")+".level";this.previousLevels.add(this.currentLevel);this.LoadLevel(path,!0);CircuitCracker.UI.CommonUI.ShowTitle(levelname,2,null)}},CanLoadPrevious:function(){return this.previousLevels.Count>0},LoadPreviousLevel:function(){var levelname,path;this.previousLevels.Count>0&&(levelname=this.previousLevels.getItem(this.previousLevels.Count-1|0),this.previousLevels.removeAt(this.previousLevels.Count-1|0),path="Levels/"+(levelname||"")+".level",this.LoadLevel(path,!0))}}});Bridge.define("CircuitCracker.LevelObjects.LevelObject",{statics:{fields:{facing2rad:0,maxScore:0,nWinBlocks:0,score:0,completed:!1},ctors:{init:function(){this.facing2rad=1.57079637;this.completed=!1}}},fields:{sprite:null,collider:null,placedOn:null,id:0,enabled:!1},ctors:{init:function(){this.enabled=!0},ctor:function(placedOn,id,rect){this.$initialize();this.placedOn=placedOn;this.id=id;CircuitCracker.LevelManager.instance.AddToUpdateList(this);this.sprite=new CircuitCracker.Sprite.ctor(rect.$clone(),placedOn.pos.$clone(),placedOn.objFacing,1)}},methods:{FixedUpdate:function(){},EditorInit:function(){},Reset:function(){},Enable:function(){this.enabled=!0},Destroy:function(){CircuitCracker.LevelManager.instance.RemoveFromUpdateList(this);this.collider!=null&&CircuitCracker.Game.world.RemoveBody(this.collider);this.sprite.Remove()},CheckWin:function(clicked){CircuitCracker.LevelObjects.LevelObject.score!==CircuitCracker.LevelObjects.LevelObject.maxScore||CircuitCracker.LevelObjects.LevelObject.completed||(CircuitCracker.LevelObjects.LevelObject.completed=!0,CircuitCracker.GameContent.SoundEffects.win.Play$1(.3,0,0));CircuitCracker.LevelObjects.LevelObject.completed&&(CircuitCracker.LevelObjects.LevelObject.nWinBlocks===0||clicked)&&(CircuitCracker.LevelObjects.LevelObject.completed=!1,CircuitCracker.LevelManager.instance.CompleteLevel())},FacingDirection:function(){switch(this.placedOn.objFacing){case 0:return Microsoft.Xna.Framework.Vector2.op_UnaryNegation(Microsoft.Xna.Framework.Vector2.UnitY.$clone());case 1:return Microsoft.Xna.Framework.Vector2.UnitX.$clone();case 2:return Microsoft.Xna.Framework.Vector2.UnitY.$clone();case 3:return Microsoft.Xna.Framework.Vector2.op_UnaryNegation(Microsoft.Xna.Framework.Vector2.UnitX.$clone());default:return Microsoft.Xna.Framework.Vector2.Zero.$clone()}}}});Bridge.define("CircuitCracker.LevelObjects.ITeleportable",{$kind:"interface"});Bridge.define("CircuitCracker.LevelObjects.ILaserhitable",{$kind:"interface"});Bridge.define("CircuitCracker.LevelObjects.IDamageable",{$kind:"interface"});Bridge.define("CircuitCracker.LevelRenderer",{statics:{fields:{facing2rad:0,transform:null,inverseTransform:null,sprites:null,overlaySprites:null,colors:null},ctors:{init:function(){this.transform=new Microsoft.Xna.Framework.Matrix;this.inverseTransform=new Microsoft.Xna.Framework.Matrix;this.facing2rad=1.57079637;this.colors=System.Array.init([new Microsoft.Xna.Framework.Color.$ctor6(16,161,255),new Microsoft.Xna.Framework.Color.$ctor6(39,190,40),new Microsoft.Xna.Framework.Color.$ctor6(247,221,61),new Microsoft.Xna.Framework.Color.$ctor6(255,163,37),new Microsoft.Xna.Framework.Color.$ctor6(255,42,42),new Microsoft.Xna.Framework.Color.$ctor6(255,138,188),new Microsoft.Xna.Framework.Color.$ctor6(24,228,200),new Microsoft.Xna.Framework.Color.$ctor6(150,130,255),new Microsoft.Xna.Framework.Color.$ctor7(6,64,100,127),new Microsoft.Xna.Framework.Color.$ctor7(15,75,15,127),new Microsoft.Xna.Framework.Color.$ctor7(96,86,24,127),new Microsoft.Xna.Framework.Color.$ctor7(100,64,15,127),new Microsoft.Xna.Framework.Color.$ctor7(100,16,16,127),new Microsoft.Xna.Framework.Color.$ctor7(100,54,74,127),new Microsoft.Xna.Framework.Color.$ctor7(10,69,59,127),new Microsoft.Xna.Framework.Color.$ctor7(50,30,80,127)],Microsoft.Xna.Framework.Color)}},methods:{MousePos:function(){var mousePos=CircuitCracker.Input.GetMousePosition();return Microsoft.Xna.Framework.Vector2.Transform(mousePos.ToVector2(),CircuitCracker.LevelRenderer.inverseTransform.$clone())},WorldToScreenPos:function(pos){return Microsoft.Xna.Framework.Vector2.Transform(pos.$clone(),CircuitCracker.LevelRenderer.transform.$clone())},AddSprite:function(sprite){sprite.SortOrder<.5?CircuitCracker.LevelRenderer.overlaySprites[sprite.ShaderId].add(sprite):CircuitCracker.LevelRenderer.sprites[sprite.ShaderId].add(sprite)},RemoveSprite:function(sprite){return sprite.SortOrder<.5?CircuitCracker.LevelRenderer.overlaySprites[sprite.ShaderId].remove(sprite):CircuitCracker.LevelRenderer.sprites[sprite.ShaderId].remove(sprite)}}},fields:{origin:null,device:null,spriteBatch:null,spriteTex:null,effects:null,tilePlacer:null,levelMap:null,levelSize:null,thumbnail:null,wireWallToSprite:null,wallRects:null,wireRects:null,gateRects:null},ctors:{init:function(){this.origin=new Microsoft.Xna.Framework.Vector2;this.levelSize=new Microsoft.Xna.Framework.Point;this.origin=new Microsoft.Xna.Framework.Vector2.$ctor2(16,16);this.wireWallToSprite=System.Array.init([new Microsoft.Xna.Framework.Vector2.$ctor2(0,0),new Microsoft.Xna.Framework.Vector2.$ctor2(1,0),new Microsoft.Xna.Framework.Vector2.$ctor2(1,1.57079637),new Microsoft.Xna.Framework.Vector2.$ctor2(2,0),new Microsoft.Xna.Framework.Vector2.$ctor2(1,3.14159274),new Microsoft.Xna.Framework.Vector2.$ctor2(3,0),new Microsoft.Xna.Framework.Vector2.$ctor2(2,1.57079637),new Microsoft.Xna.Framework.Vector2.$ctor2(4,0),new Microsoft.Xna.Framework.Vector2.$ctor2(1,4.712389),new Microsoft.Xna.Framework.Vector2.$ctor2(2,4.712389),new Microsoft.Xna.Framework.Vector2.$ctor2(3,4.712389),new Microsoft.Xna.Framework.Vector2.$ctor2(4,4.712389),new Microsoft.Xna.Framework.Vector2.$ctor2(2,3.14159274),new Microsoft.Xna.Framework.Vector2.$ctor2(4,3.14159274),new Microsoft.Xna.Framework.Vector2.$ctor2(4,1.57079637),new Microsoft.Xna.Framework.Vector2.$ctor2(5,0),new Microsoft.Xna.Framework.Vector2.$ctor2(6,4.712389)],Microsoft.Xna.Framework.Vector2);this.wallRects=System.Array.init([CircuitCracker.Sprites.Wall5.$clone(),CircuitCracker.Sprites.Wall0.$clone(),CircuitCracker.Sprites.Wall1.$clone(),CircuitCracker.Sprites.Wall2.$clone(),CircuitCracker.Sprites.Wall3.$clone(),CircuitCracker.Sprites.Wall4.$clone(),CircuitCracker.Sprites.Floor.$clone()],Microsoft.Xna.Framework.Rectangle);this.wireRects=System.Array.init([CircuitCracker.Sprites.None.$clone(),CircuitCracker.Sprites.Wire0.$clone(),CircuitCracker.Sprites.Wire1.$clone(),CircuitCracker.Sprites.Wire2.$clone(),CircuitCracker.Sprites.Wire3.$clone(),CircuitCracker.Sprites.Wire4.$clone(),CircuitCracker.Sprites.Wire5.$clone()],Microsoft.Xna.Framework.Rectangle);this.gateRects=System.Array.init([CircuitCracker.Sprites.None.$clone(),CircuitCracker.Sprites.Not.$clone(),CircuitCracker.Sprites.And.$clone(),CircuitCracker.Sprites.Or.$clone(),CircuitCracker.Sprites.Xor.$clone(),CircuitCracker.Sprites.Toggle.$clone()],Microsoft.Xna.Framework.Rectangle)},ctor:function(device,spriteBatch,spriteTex,tilePlacer){this.$initialize();this.device=device;this.spriteBatch=spriteBatch;this.spriteTex=spriteTex;this.tilePlacer=tilePlacer;this.effects=System.Array.init([null,CircuitCracker.GameContent.ShaderEffect.inverse,CircuitCracker.GameContent.ShaderEffect.dissolve,CircuitCracker.GameContent.ShaderEffect.materialize,CircuitCracker.GameContent.ShaderEffect.teleport],Microsoft.Xna.Framework.Graphics.Effect);CircuitCracker.LevelRenderer.overlaySprites=System.Array.init(this.effects.length,null,System.Collections.Generic.List$1(CircuitCracker.Sprite));CircuitCracker.LevelRenderer.sprites=System.Array.init(this.effects.length,null,System.Collections.Generic.List$1(CircuitCracker.Sprite));for(var i=0;i<this.effects.length;i=i+1|0)CircuitCracker.LevelRenderer.overlaySprites[i]=new(System.Collections.Generic.List$1(CircuitCracker.Sprite).ctor),CircuitCracker.LevelRenderer.sprites[i]=new(System.Collections.Generic.List$1(CircuitCracker.Sprite).ctor);this.thumbnail=new Microsoft.Xna.Framework.Graphics.RenderTarget2D.ctor(device,272,144);this.Resize(1088,576)}},methods:{InitLevelRenderer:function(levelMap,levelSize){this.levelMap=levelMap;this.levelSize=levelSize.$clone()},Resize:function(width,height){var scale=Microsoft.Xna.Framework.Vector3.One.$clone(),translate=Microsoft.Xna.Framework.Vector3.Zero.$clone(),aspect=1.88888884;width/height<aspect?(scale.X=width,scale.Y=width/aspect):(scale.X=height*aspect,scale.Y=height);translate.X=Bridge.Int.clip32((this.device.Viewport.Width-scale.X)/2+scale.X/34*1.5)+.5;translate.Y=Bridge.Int.clip32((this.device.Viewport.Height-scale.Y)/2+scale.Y/18*1.5)+.5;CircuitCracker.LevelRenderer.transform=Microsoft.Xna.Framework.Matrix.op_Multiply(Microsoft.Xna.Framework.Matrix.CreateOrthographic(34,18,0,-1),Microsoft.Xna.Framework.Matrix.CreateScale(Microsoft.Xna.Framework.Vector3.op_Division$1(scale.$clone(),2)));CircuitCracker.LevelRenderer.transform.Translation=translate.$clone();CircuitCracker.LevelRenderer.inverseTransform=Microsoft.Xna.Framework.Matrix.Invert(CircuitCracker.LevelRenderer.transform.$clone())},RenderThumbnail:function(map){var tmp=this.levelMap;return this.levelMap=map,this.device.SetRenderTarget(this.thumbnail),this.Resize(this.thumbnail.Bounds.Width,this.thumbnail.Bounds.Height),this.device.Clear(Microsoft.Xna.Framework.Color.Transparent.$clone()),this.DrawThumbnailBackground(),this.DrawWires(),this.device.SetRenderTarget(null),this.Resize(1088,576),this.levelMap=tmp,this.thumbnail},DrawOverlays:function(time){},DrawThumbnailBackground:function(){var x,y,rot;for(this.spriteBatch.Begin(0,void 0,Microsoft.Xna.Framework.Graphics.SamplerState.PointWrap,void 0,void 0,void 0,CircuitCracker.LevelRenderer.transform),x=0;x<this.levelSize.X;x=x+1|0)for(y=0;y<this.levelSize.Y;y=y+1|0){var destRect=new Microsoft.Xna.Framework.Rectangle.$ctor2(x,y,1,1),tile=this.levelMap.get([x,y]),rect=tile.wall?CircuitCracker.Sprites.Wall4.$clone():CircuitCracker.Sprites.Floor.$clone();this.spriteBatch.Draw$2(this.spriteTex,destRect.$clone(),rect.$clone(),Microsoft.Xna.Framework.Color.White.$clone(),0,this.origin.$clone(),Microsoft.Xna.Framework.Graphics.SpriteEffects.None,0);tile.objId>=0&&(rot=(Bridge.Int.div(tile.objFacing,2)|0)*CircuitCracker.LevelRenderer.facing2rad,rect=this.tilePlacer.GetObjectRect(tile.objId),this.spriteBatch.Draw$2(this.spriteTex,destRect.$clone(),rect.$clone(),Microsoft.Xna.Framework.Color.White.$clone(),rot,this.origin.$clone(),Microsoft.Xna.Framework.Graphics.SpriteEffects.None,0))}this.spriteBatch.End()},DrawSprites:function(){for(var s,$t,i=0;i<this.effects.length;i=i+1|0)if(CircuitCracker.LevelRenderer.sprites[i].Count>0){this.spriteBatch.Begin(Microsoft.Xna.Framework.Graphics.SpriteSortMode.BackToFront,void 0,Microsoft.Xna.Framework.Graphics.SamplerState.PointWrap,void 0,void 0,this.effects[i],CircuitCracker.LevelRenderer.transform);$t=Bridge.getEnumerator(CircuitCracker.LevelRenderer.sprites[i]);try{while($t.moveNext())s=$t.Current,this.spriteBatch.Draw$5(this.spriteTex,s.position.$clone(),s.rect.$clone(),s.color.$clone(),s.rotation,this.origin.$clone(),s.scale.$clone(),s.effects,s.SortOrder)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}this.spriteBatch.End()}},DrawWalls:function(){var x,y,destRect,wall,st;for(this.spriteBatch.Begin(0,void 0,Microsoft.Xna.Framework.Graphics.SamplerState.PointWrap,void 0,void 0,void 0,CircuitCracker.LevelRenderer.transform),x=0;x<(this.levelSize.X+2|0);x=x+1|0)for(y=0;y<(this.levelSize.Y+2|0);y=y+1|0)destRect=new Microsoft.Xna.Framework.Rectangle.$ctor2(x-1|0,y-1|0,1,1),wall=this.tilePlacer.walls.get([x,y]),wall<0&&(wall=16),st=this.wireWallToSprite[wall].$clone(),this.spriteBatch.Draw$2(this.spriteTex,destRect.$clone(),this.wallRects[Bridge.Int.clip32(st.X)].$clone(),Microsoft.Xna.Framework.Color.White.$clone(),st.Y,this.origin.$clone(),Microsoft.Xna.Framework.Graphics.SpriteEffects.None,0);this.spriteBatch.End()},DrawWires:function(){var x,y,destRect,tile,i,wire,color,c,st,gate,c1;for(this.spriteBatch.Begin(0,void 0,Microsoft.Xna.Framework.Graphics.SamplerState.PointWrap,void 0,void 0,void 0,CircuitCracker.LevelRenderer.transform),x=0;x<this.levelSize.X;x=x+1|0)for(y=0;y<this.levelSize.Y;y=y+1|0){for(destRect=new Microsoft.Xna.Framework.Rectangle.$ctor2(x,y,1,1),tile=this.levelMap.get([x,y]),i=0;i<4;i=i+1|0)(wire=tile.wire>>Bridge.Int.mul(4,i)&15,color=tile.color>>Bridge.Int.mul(3,i)&7,wire!==0)&&(tile.wire===165&&wire===10&&(wire=16),c=CircuitCracker.LevelRenderer.colors[tile.signalStrength[i]>0?color:color+8|0].$clone(),st=this.wireWallToSprite[wire].$clone(),this.spriteBatch.Draw$2(this.spriteTex,destRect.$clone(),this.wireRects[Bridge.Int.clip32(st.X)].$clone(),c.$clone(),st.Y,this.origin.$clone(),Microsoft.Xna.Framework.Graphics.SpriteEffects.None,0));gate=tile.gate;gate>0&&(c1=tile.signalStrength[0]===1?Microsoft.Xna.Framework.Color.White:new Microsoft.Xna.Framework.Color.$ctor7(40,40,40,127),this.spriteBatch.Draw$2(this.spriteTex,destRect.$clone(),this.gateRects[gate].$clone(),c1.$clone(),tile.gateFacing*CircuitCracker.LevelRenderer.facing2rad,this.origin.$clone(),Microsoft.Xna.Framework.Graphics.SpriteEffects.None,0))}this.spriteBatch.End()}}});Bridge.define("CircuitCracker.LevelTile",{fields:{pos:null,wire:0,color:0,gate:0,gateFacing:0,objId:0,objFacing:0,wall:!1,objData:null,obj:null,source:!1,signalStrength:null,nextStrength:null,minNearStrength:null,tmpWire:0,lastLayerAdded:0},ctors:{init:function(){this.pos=new Microsoft.Xna.Framework.Point;this.objId=-1;this.signalStrength=System.Array.init(new Int32Array(4),System.Int32);this.nextStrength=System.Array.init(new Int32Array(4),System.Int32);this.minNearStrength=System.Array.init(new Int32Array(4),System.Int32)},ctor:function(x,y){this.$initialize();this.pos=new Microsoft.Xna.Framework.Point.$ctor2(x,y)}},methods:{DestroyObject:function(){this.obj!=null?this.obj.Destroy():null;this.objId=-1;this.objFacing=0;this.obj=null;this.objData=null},HasWire:function(position){return this.GetWireLayer(position)!==-1},HasWire$1:function(position,layer){return this.GetWireLayer(position)===layer},GetWireLayer:function(position){switch(this.wire>>position&4369){case 1:return 0;case 16:return 1;case 256:return 2;case 4096:return 3;default:return-1}},ClearWire:function(position){this.wire=this.wire&~(4369<<position);this.tmpWire=this.wire},GetTmpLayer:function(layer){return this.tmpWire>>Bridge.Int.mul(4,layer)&15},CombineLayers:function(){this.tmpWire=(this.tmpWire|this.tmpWire>>4|this.tmpWire>>8|this.tmpWire>>12)&15;this.lastLayerAdded=0},GetCombinedLayers:function(){return(this.tmpWire|this.tmpWire>>4|this.tmpWire>>8|this.tmpWire>>12)&15},AddTmpLayer:function(layer){for(var i=0;i<4;i=i+1|0)if(this.GetTmpLayer(i)===0){this.tmpWire=this.tmpWire|layer<<Bridge.Int.mul(4,i);this.lastLayerAdded=i;return}},SetColor:function(layer,color){this.color=this.color&~(7<<Bridge.Int.mul(3,layer));this.color=this.color|color<<Bridge.Int.mul(3,layer)},GetColor:function(layer){return this.color>>Bridge.Int.mul(3,layer)&7},SetObjectColor:function(color){this.SetColor(4,color)},GetObjectColor:function(){return this.GetColor(4)}}});Bridge.define("CircuitCracker.Mode",{$kind:"enum",statics:{fields:{Wire:0,Gate:1,Wall:2,Object:3}}});Bridge.define("CircuitCracker.MouseButton",{$kind:"enum",statics:{fields:{None:0,Left:1,Middle:2,Right:4}},$flags:!0});Bridge.define("CircuitCracker.PlacerMode",{fields:{mode:0,sprite:null,decalSprite:null,id:0,canRotate:!1},ctors:{init:function(){this.sprite=new Microsoft.Xna.Framework.Rectangle;this.decalSprite=new Microsoft.Xna.Framework.Rectangle},ctor:function(mode,sprite,id,canRotate,decalSprite){decalSprite===void 0&&(decalSprite=null);this.$initialize();this.mode=mode;this.sprite=sprite.$clone();this.id=id;this.canRotate=canRotate;this.decalSprite=System.Nullable.getValueOrDefault(decalSprite,new Microsoft.Xna.Framework.Rectangle).$clone()}}});Bridge.define("CircuitCracker.Settings",{fields:{musicVolume:0,effectVolume:0,fullscreen:!1,sprintMode:0,settings:null,uiBuilt:!1,sprintNames:null,discordLink:null},ctors:{init:function(){this.musicVolume=.6;this.effectVolume=1;this.fullscreen=!1;this.sprintMode=1;this.sprintNames=System.Array.init(["Hold to run","Release to run","Toggle run"],System.String);this.discordLink="https://discord.gg/QQn74H7"}},methods:{Show:function(){this.uiBuilt||this.BuildUI();this.settings.SetVisible(!0)},Hide:function(){this.settings.SetVisible(!1)},BuildUI:function(){var infos,main;this.settings=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.Panel,new CircuitCracker.UI.Panel.$ctor1(new Microsoft.Xna.Framework.Color.$ctor9(0,0,0,.4)),CircuitCracker.UI.AnchorX.Stretch,CircuitCracker.UI.AnchorY.Stretch);infos=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.VerticalLayout,new CircuitCracker.UI.VerticalLayout(5,[CircuitCracker.UI.UIBuilder.BackgroundColor(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.ctor("Web-Version 0.3",Microsoft.Xna.Framework.Color.op_Multiply(Microsoft.Xna.Framework.Color.White.$clone(),.75)),Microsoft.Xna.Framework.Color.op_Multiply(Microsoft.Xna.Framework.Color.Black.$clone(),.5)),CircuitCracker.UI.UIBuilder.BackgroundColor(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.ctor("Copyright (c) 2020-2021 Lorenz Auer & Felix Schmid",Microsoft.Xna.Framework.Color.op_Multiply(Microsoft.Xna.Framework.Color.White.$clone(),.75)),Microsoft.Xna.Framework.Color.op_Multiply(Microsoft.Xna.Framework.Color.Black.$clone(),.5))]),CircuitCracker.UI.AnchorX.Left,CircuitCracker.UI.AnchorY.Bottom);infos.margin=20;infos.SetParent(this.settings);main=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.VerticalLayout,new CircuitCracker.UI.VerticalLayout(5,[CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.$ctor1("Settings",!0),CircuitCracker.UI.AnchorX.Stretch),new CircuitCracker.UI.HorizontalLayout(2,[new CircuitCracker.UI.VerticalLayout(5,[CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.$ctor1("Effect Volume"),CircuitCracker.UI.AnchorX.Stretch),CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.$ctor1("Sprint Behaviour"),CircuitCracker.UI.AnchorX.Stretch)]),new CircuitCracker.UI.VerticalLayout(5,[new CircuitCracker.UI.Slider.$ctor1(Bridge.fn.bind(this,function(v){this.effectVolume=v;Microsoft.Xna.Framework.Audio.SoundEffect.MasterVolume=v}),200,this.effectVolume),CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.Dropdown,new CircuitCracker.UI.Dropdown(this.sprintNames,this.sprintMode,Bridge.fn.bind(this,function(value){this.sprintMode=value})),CircuitCracker.UI.AnchorX.Stretch)])]),CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.Button,new CircuitCracker.UI.Button("Ok",Bridge.fn.cacheBind(this,this.Hide)),CircuitCracker.UI.AnchorX.Right)]),CircuitCracker.UI.AnchorX.Center,CircuitCracker.UI.AnchorY.Center);main.SetParent(this.settings);this.uiBuilt=!0}}});Bridge.define("CircuitCracker.Shader",{$kind:"enum",statics:{fields:{None:0,Invert:1,Dissolve:2,Materialize:3,Teleport:4}}});Bridge.define("CircuitCracker.Sprite",{statics:{fields:{facing2rad:0},ctors:{init:function(){this.facing2rad=1.57079637}}},fields:{rect:null,color:null,scale:null,position:null,effects:0,rotation:0,SortOrder:0,ShaderId:0,enabled:!1},ctors:{init:function(){this.rect=new Microsoft.Xna.Framework.Rectangle;this.color=new Microsoft.Xna.Framework.Color;this.scale=new Microsoft.Xna.Framework.Vector2;this.position=new Microsoft.Xna.Framework.Vector2;this.color=Microsoft.Xna.Framework.Color.White.$clone();this.scale=Microsoft.Xna.Framework.Vector2.op_Division$1(Microsoft.Xna.Framework.Vector2.One.$clone(),32);this.enabled=!0},ctor:function(rect,tilePos,facing,sortOrder,color){color===void 0&&(color=new Microsoft.Xna.Framework.Color);CircuitCracker.Sprite.$ctor1.call(this,rect,tilePos.ToVector2(),facing*CircuitCracker.Sprite.facing2rad,sortOrder,color)},$ctor1:function(rect,position,rotation,sortOrder,color){color===void 0&&(color=new Microsoft.Xna.Framework.Color);this.$initialize();this.rect=rect.$clone();this.position=position.$clone();this.rotation=rotation;this.SortOrder=sortOrder;CircuitCracker.LevelRenderer.AddSprite(this)}},methods:{Remove:function(){CircuitCracker.LevelRenderer.RemoveSprite(this)},SetEnabled:function(enabled){this.enabled!==enabled&&(this.enabled=enabled,enabled?CircuitCracker.LevelRenderer.AddSprite(this):CircuitCracker.LevelRenderer.RemoveSprite(this))},SetSortOrder:function(sortOrder){var removed=CircuitCracker.LevelRenderer.RemoveSprite(this);this.SortOrder=CircuitCracker.Utilities.Clamp$1(sortOrder,0,1);removed&&CircuitCracker.LevelRenderer.AddSprite(this)},SetShader:function(shader){var removed=CircuitCracker.LevelRenderer.RemoveSprite(this);this.ShaderId=shader;removed&&CircuitCracker.LevelRenderer.AddSprite(this)}}});Bridge.define("CircuitCracker.Sprites",{statics:{fields:{None:null,Wall0:null,Wall1:null,Wall2:null,Wall3:null,Wall4:null,Wall5:null,Floor:null,Wire0:null,Wire1:null,Wire2:null,Wire3:null,Wire4:null,Wire5:null,Not:null,And:null,Or:null,Xor:null,Toggle:null,Box:null,HalfBox:null,SelectBorder:null,Door0:null,Door1:null,Door2:null,Door3:null,PlateActive:null,PlateInactive:null,CrateNormal:null,CrateMetal:null,PlayerWalking0:null,PlayerWalking1:null,PlayerPushing0:null,PlayerPushing1:null,Reseter:null,ReseterArrow:null,Goal:null,Conveyor:null,SpikeActive:null,SpikeInactive:null,Laser0:null,Laser1:null,Laser2:null,Laser3:null,DetectorActive:null,DetectorInactive:null,WinblockActive:null,WinblockInactive:null,TeleporterActive:null,TeleporterInactive:null,Robot:null,RobotDecal:null,RobotBase:null,RobotSensor:null,RobotSensorDecal:null,PistonBody:null,PistonHead:null,LevelLinkLocked:null,LevelLinkUnlocked:null,LevelLinkComplete:null,SaveGame:null,Back:null,Reset:null,Options:null,MessageBox:null},ctors:{init:function(){this.None=new Microsoft.Xna.Framework.Rectangle;this.Wall0=new Microsoft.Xna.Framework.Rectangle;this.Wall1=new Microsoft.Xna.Framework.Rectangle;this.Wall2=new Microsoft.Xna.Framework.Rectangle;this.Wall3=new Microsoft.Xna.Framework.Rectangle;this.Wall4=new Microsoft.Xna.Framework.Rectangle;this.Wall5=new Microsoft.Xna.Framework.Rectangle;this.Floor=new Microsoft.Xna.Framework.Rectangle;this.Wire0=new Microsoft.Xna.Framework.Rectangle;this.Wire1=new Microsoft.Xna.Framework.Rectangle;this.Wire2=new Microsoft.Xna.Framework.Rectangle;this.Wire3=new Microsoft.Xna.Framework.Rectangle;this.Wire4=new Microsoft.Xna.Framework.Rectangle;this.Wire5=new Microsoft.Xna.Framework.Rectangle;this.Not=new Microsoft.Xna.Framework.Rectangle;this.And=new Microsoft.Xna.Framework.Rectangle;this.Or=new Microsoft.Xna.Framework.Rectangle;this.Xor=new Microsoft.Xna.Framework.Rectangle;this.Toggle=new Microsoft.Xna.Framework.Rectangle;this.Box=new Microsoft.Xna.Framework.Rectangle;this.HalfBox=new Microsoft.Xna.Framework.Rectangle;this.SelectBorder=new Microsoft.Xna.Framework.Rectangle;this.Door0=new Microsoft.Xna.Framework.Rectangle;this.Door1=new Microsoft.Xna.Framework.Rectangle;this.Door2=new Microsoft.Xna.Framework.Rectangle;this.Door3=new Microsoft.Xna.Framework.Rectangle;this.PlateActive=new Microsoft.Xna.Framework.Rectangle;this.PlateInactive=new Microsoft.Xna.Framework.Rectangle;this.CrateNormal=new Microsoft.Xna.Framework.Rectangle;this.CrateMetal=new Microsoft.Xna.Framework.Rectangle;this.PlayerWalking0=new Microsoft.Xna.Framework.Rectangle;this.PlayerWalking1=new Microsoft.Xna.Framework.Rectangle;this.PlayerPushing0=new Microsoft.Xna.Framework.Rectangle;this.PlayerPushing1=new Microsoft.Xna.Framework.Rectangle;this.Reseter=new Microsoft.Xna.Framework.Rectangle;this.ReseterArrow=new Microsoft.Xna.Framework.Rectangle;this.Goal=new Microsoft.Xna.Framework.Rectangle;this.Conveyor=new Microsoft.Xna.Framework.Rectangle;this.SpikeActive=new Microsoft.Xna.Framework.Rectangle;this.SpikeInactive=new Microsoft.Xna.Framework.Rectangle;this.Laser0=new Microsoft.Xna.Framework.Rectangle;this.Laser1=new Microsoft.Xna.Framework.Rectangle;this.Laser2=new Microsoft.Xna.Framework.Rectangle;this.Laser3=new Microsoft.Xna.Framework.Rectangle;this.DetectorActive=new Microsoft.Xna.Framework.Rectangle;this.DetectorInactive=new Microsoft.Xna.Framework.Rectangle;this.WinblockActive=new Microsoft.Xna.Framework.Rectangle;this.WinblockInactive=new Microsoft.Xna.Framework.Rectangle;this.TeleporterActive=new Microsoft.Xna.Framework.Rectangle;this.TeleporterInactive=new Microsoft.Xna.Framework.Rectangle;this.Robot=new Microsoft.Xna.Framework.Rectangle;this.RobotDecal=new Microsoft.Xna.Framework.Rectangle;this.RobotBase=new Microsoft.Xna.Framework.Rectangle;this.RobotSensor=new Microsoft.Xna.Framework.Rectangle;this.RobotSensorDecal=new Microsoft.Xna.Framework.Rectangle;this.PistonBody=new Microsoft.Xna.Framework.Rectangle;this.PistonHead=new Microsoft.Xna.Framework.Rectangle;this.LevelLinkLocked=new Microsoft.Xna.Framework.Rectangle;this.LevelLinkUnlocked=new Microsoft.Xna.Framework.Rectangle;this.LevelLinkComplete=new Microsoft.Xna.Framework.Rectangle;this.SaveGame=new Microsoft.Xna.Framework.Rectangle;this.Back=new Microsoft.Xna.Framework.Rectangle;this.Reset=new Microsoft.Xna.Framework.Rectangle;this.Options=new Microsoft.Xna.Framework.Rectangle;this.MessageBox=new Microsoft.Xna.Framework.Rectangle;this.None=Microsoft.Xna.Framework.Rectangle.Empty.$clone();this.Wall0=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,64,32,32);this.Wall1=new Microsoft.Xna.Framework.Rectangle.$ctor2(32,64,32,32);this.Wall2=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,64,32,32);this.Wall3=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,64,32,32);this.Wall4=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,64,32,32);this.Wall5=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,64,32,32);this.Floor=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,96,32,32);this.Wire0=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,32,32,32);this.Wire1=new Microsoft.Xna.Framework.Rectangle.$ctor2(32,32,32,32);this.Wire2=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,32,32,32);this.Wire3=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,32,32,32);this.Wire4=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,32,32,32);this.Wire5=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,32,32,32);this.Not=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,32,32,32);this.And=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,64,32,32);this.Or=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,32,32,32);this.Xor=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,64,32,32);this.Toggle=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,96,32,32);this.Box=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,224,32,32);this.HalfBox=new Microsoft.Xna.Framework.Rectangle.$ctor2(80,240,16,16);this.SelectBorder=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,224,32,32);this.Door0=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,96,32,32);this.Door1=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,96,32,32);this.Door2=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,96,32,32);this.Door3=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,96,32,32);this.PlateActive=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,96,32,32);this.PlateInactive=new Microsoft.Xna.Framework.Rectangle.$ctor2(32,96,32,32);this.CrateNormal=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,128,32,32);this.CrateMetal=new Microsoft.Xna.Framework.Rectangle.$ctor2(32,128,32,32);this.PlayerWalking0=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,160,32,32);this.PlayerWalking1=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,160,32,32);this.PlayerPushing0=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,160,32,32);this.PlayerPushing1=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,160,32,32);this.Reseter=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,224,32,32);this.ReseterArrow=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,224,32,32);this.Goal=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,192,32,32);this.Conveyor=new Microsoft.Xna.Framework.Rectangle.$ctor2(32,160,32,32);this.SpikeActive=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,192,32,32);this.SpikeInactive=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,192,32,32);this.Laser0=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,128,32,32);this.Laser1=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,128,32,32);this.Laser2=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,128,32,32);this.Laser3=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,128,32,32);this.DetectorActive=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,128,32,32);this.DetectorInactive=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,128,32,32);this.WinblockActive=new Microsoft.Xna.Framework.Rectangle.$ctor2(64,0,32,32);this.WinblockInactive=new Microsoft.Xna.Framework.Rectangle.$ctor2(32,0,32,32);this.TeleporterActive=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,192,32,32);this.TeleporterInactive=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,192,32,32);this.Robot=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,160,32,32);this.RobotDecal=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,160,32,32);this.RobotBase=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,192,32,32);this.RobotSensor=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,224,32,32);this.RobotSensorDecal=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,224,32,32);this.PistonBody=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,192,32,32);this.PistonHead=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,160,32,32);this.LevelLinkLocked=new Microsoft.Xna.Framework.Rectangle.$ctor2(96,0,32,32);this.LevelLinkUnlocked=new Microsoft.Xna.Framework.Rectangle.$ctor2(128,0,32,32);this.LevelLinkComplete=new Microsoft.Xna.Framework.Rectangle.$ctor2(160,0,32,32);this.SaveGame=new Microsoft.Xna.Framework.Rectangle.$ctor2(192,0,32,32);this.Back=new Microsoft.Xna.Framework.Rectangle.$ctor2(224,0,32,32);this.Reset=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,224,32,32);this.Options=new Microsoft.Xna.Framework.Rectangle.$ctor2(32,224,32,32);this.MessageBox=new Microsoft.Xna.Framework.Rectangle.$ctor2(0,0,32,32)}}}});Bridge.define("CircuitCracker.StartMenu",{fields:{menu:null,uiBuilt:!1},methods:{Show:function(){this.uiBuilt?this.menu.SetVisible(!0):this.BuildUI()},Hide:function(){this.menu.SetVisible(!1)},BuildUI:function(){this.menu=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.Panel,new CircuitCracker.UI.Panel.$ctor1(new Microsoft.Xna.Framework.Color.$ctor9(0,0,0,.4)),CircuitCracker.UI.AnchorX.Stretch,CircuitCracker.UI.AnchorY.Stretch);var vertical=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.VerticalLayout,new CircuitCracker.UI.VerticalLayout(5,[CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.$ctor1("Circuit Cracker",!0),CircuitCracker.UI.AnchorX.Stretch),CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.Button,new CircuitCracker.UI.Button("Start new game",Bridge.fn.bind(this,function(){this.Hide();CircuitCracker.Game.paused=!1})),CircuitCracker.UI.AnchorX.Stretch),CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.Button,new CircuitCracker.UI.Button("Import game save",function(){CircuitCracker.Stats.LoadStats()}),CircuitCracker.UI.AnchorX.Stretch)]),CircuitCracker.UI.AnchorX.Center,CircuitCracker.UI.AnchorY.Center);vertical.SetParent(this.menu);this.uiBuilt=!0}}});Bridge.define("CircuitCracker.Stats",{statics:{fields:{stats:null,current:null,currentTime:0,fr:null},ctors:{init:function(){this.stats=new(System.Collections.Generic.Dictionary$2(System.String,CircuitCracker.Stats.LevelStats));this.fr=new FileReader}},methods:{LoadStats:function(){CircuitCracker.Stats.stats.clear();var element=Bridge.cast(document.getElementById("fileinput"),HTMLInputElement);element.click();element.onchange=CircuitCracker.Stats.Load},Load:function(ev){var element=Bridge.cast(document.getElementById("fileinput"),HTMLInputElement);CircuitCracker.Stats.fr.onload=CircuitCracker.Stats.Read;CircuitCracker.Stats.fr.readAsText(element.files.item(0))},Read:function(ev){for(var reader=new System.IO.StringReader(Bridge.cast(CircuitCracker.Stats.fr.result,System.String)),l=reader.ReadLine(),firstLine=!0,line,completed,fastestTime,firstTime,resets,deaths;l!=null;)line=System.String.split(l,[47].map(function(i){return String.fromCharCode(i)})),firstLine||line.length!==6||CircuitCracker.Stats.stats.containsKey(line[0])||(completed={},System.Boolean.tryParse(line[1],completed),fastestTime={},System.Double.tryParse(line[2],null,fastestTime),firstTime={},System.Double.tryParse(line[3],null,firstTime),resets={},System.Int32.tryParse(line[4],resets),deaths={},System.Int32.tryParse(line[5],deaths),CircuitCracker.Stats.stats.add(line[0],new CircuitCracker.Stats.LevelStats(completed.v,fastestTime.v,firstTime.v,resets.v,deaths.v))),l=reader.ReadLine(),firstLine=!1;CircuitCracker.LevelManager.instance.ReloadLinkStates();CircuitCracker.Game.startMenu.Hide();CircuitCracker.Game.paused=!1},SaveStats:function(){var $t,sb=new System.Text.StringBuilder,stat;sb.appendLine("levelname/completed/fastest time/first time/resets/deaths");$t=Bridge.getEnumerator(CircuitCracker.Stats.stats);try{while($t.moveNext())stat=$t.Current,sb.append(stat.key),sb.append(String.fromCharCode(47)),sb.append(stat.value.cleared),sb.append(String.fromCharCode(47)),sb.append(Bridge.Int.clip32(stat.value.fastestTime)),sb.append(String.fromCharCode(47)),sb.append(Bridge.Int.clip32(stat.value.firstTime)),sb.append(String.fromCharCode(47)),sb.append(stat.value.resets),sb.append(String.fromCharCode(47)),sb.append(stat.value.deaths),sb.appendLine()}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}var blob=new Blob(System.Array.init([sb.toString()],System.Object)),url=window.URL.createObjectURL(blob),element=document.getElementById("filedownload");element.setAttribute("download","CircuitCracker_gamesave.sav");element.setAttribute("href",url);element.click();window.URL.revokeObjectURL(url)},ChangeLevel:function(newLevel){CircuitCracker.Stats.stats.containsKey(newLevel)?CircuitCracker.Stats.current=CircuitCracker.Stats.stats.get(newLevel):(CircuitCracker.Stats.current=new CircuitCracker.Stats.LevelStats(!1,0,0,0,0),CircuitCracker.Stats.stats.add(newLevel,CircuitCracker.Stats.current));CircuitCracker.Stats.currentTime=0},LevelCleared:function(){CircuitCracker.Stats.current!=null&&(CircuitCracker.Stats.current.cleared=!0,(CircuitCracker.Stats.current.fastestTime===0||CircuitCracker.Stats.current.fastestTime>CircuitCracker.Stats.currentTime)&&(CircuitCracker.Stats.current.fastestTime=CircuitCracker.Stats.currentTime))},AddTime:function(seconds){CircuitCracker.Stats.current==null||CircuitCracker.Stats.current.cleared||(CircuitCracker.Stats.current.firstTime+=seconds);CircuitCracker.Stats.currentTime+=seconds},AddReset:function(){CircuitCracker.Stats.current==null||CircuitCracker.Stats.current.cleared||(CircuitCracker.Stats.current.resets=CircuitCracker.Stats.current.resets+1|0);CircuitCracker.Stats.currentTime=0},AddDeath:function(){CircuitCracker.Stats.current==null||CircuitCracker.Stats.current.cleared||(CircuitCracker.Stats.current.deaths=CircuitCracker.Stats.current.deaths+1|0)},HasClearedLevel:function(levelname){var stat={};return CircuitCracker.Stats.stats.tryGetValue(levelname,stat)?stat.v.cleared:!1}}}});Bridge.define("CircuitCracker.Stats.LevelStats",{$kind:"nested class",fields:{cleared:!1,fastestTime:0,firstTime:0,resets:0,deaths:0},ctors:{ctor:function(cleared,fastestTime,firstTime,resets,deaths){this.$initialize();this.cleared=cleared;this.fastestTime=fastestTime;this.firstTime=firstTime;this.resets=resets;this.deaths=deaths}}});Bridge.define("CircuitCracker.TilePlacer",{statics:{fields:{objectTypes:null},ctors:{init:function(){this.objectTypes=System.Array.init([CircuitCracker.LevelObjects.Door,CircuitCracker.LevelObjects.Plate,CircuitCracker.LevelObjects.Crate,CircuitCracker.LevelObjects.Player,CircuitCracker.LevelObjects.Goal,CircuitCracker.LevelObjects.Conveyor,CircuitCracker.LevelObjects.Spike,CircuitCracker.LevelObjects.Laser,CircuitCracker.LevelObjects.Detector,CircuitCracker.LevelObjects.MetalCrate,CircuitCracker.LevelObjects.InversePlayer,CircuitCracker.LevelObjects.WinBlock,CircuitCracker.LevelObjects.Teleporter,CircuitCracker.LevelObjects.Robot,CircuitCracker.LevelObjects.Piston,CircuitCracker.LevelObjects.LevelLink,CircuitCracker.LevelObjects.RobotSensor,CircuitCracker.LevelObjects.MessageBox,CircuitCracker.LevelObjects.Resetor],Function)}}},fields:{wallColliders:null,modes:null,dirs:null,oppDirs:null,MousePosValid:!1,walls:null,levelMap:null,levelSize:null,wallSizeX:0,wallSizeY:0,wallsDirty:!1},ctors:{init:function(){this.levelSize=new Microsoft.Xna.Framework.Point;this.wallColliders=new(System.Collections.Generic.Stack$1(VelcroPhysics.Dynamics.Body).ctor);this.modes=System.Array.init([new CircuitCracker.PlacerMode(CircuitCracker.Mode.Wire,CircuitCracker.Sprites.None.$clone(),0,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Wire,CircuitCracker.Sprites.None.$clone(),1,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Wire,CircuitCracker.Sprites.None.$clone(),2,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Wire,CircuitCracker.Sprites.None.$clone(),3,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Gate,CircuitCracker.Sprites.Not.$clone(),1,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Gate,CircuitCracker.Sprites.And.$clone(),2,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Gate,CircuitCracker.Sprites.Or.$clone(),3,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Gate,CircuitCracker.Sprites.Xor.$clone(),4,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Gate,CircuitCracker.Sprites.Toggle.$clone(),5,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Wall,CircuitCracker.Sprites.Wall5.$clone(),0,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.Door0.$clone(),0,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.PlateActive.$clone(),1,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.CrateNormal.$clone(),2,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.CrateMetal.$clone(),9,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.PlayerWalking0.$clone(),3,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.PlayerWalking0.$clone(),10,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.Goal.$clone(),4,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.Conveyor.$clone(),5,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.SpikeActive.$clone(),6,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.Laser3.$clone(),7,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.DetectorActive.$clone(),8,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.TeleporterActive.$clone(),12,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.Robot.$clone(),13,!0,CircuitCracker.Sprites.RobotDecal.$clone()),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.RobotSensor.$clone(),16,!0,CircuitCracker.Sprites.RobotSensorDecal.$clone()),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.PistonBody.$clone(),14,!0),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.WinblockActive.$clone(),11,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.LevelLinkUnlocked.$clone(),15,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.MessageBox.$clone(),17,!1),new CircuitCracker.PlacerMode(CircuitCracker.Mode.Object,CircuitCracker.Sprites.Reseter.$clone(),18,!0)],CircuitCracker.PlacerMode);this.dirs=System.Array.create(0,[[0,-1],[1,0],[0,1],[-1,0]],System.Int32,4,2);this.oppDirs=System.Array.init([2,3,0,1],System.Int32)}},methods:{InitTilePlacer:function(levelMap,levelSize,menuItems){var $t,i,tile;for(this.levelMap=levelMap,this.levelSize=levelSize.$clone(),this.wallSizeX=levelSize.X+2|0,this.wallSizeY=levelSize.Y+2|0,this.walls=System.Array.create(0,null,System.Int32,this.wallSizeX,this.wallSizeY),this.InitWalls(),i=0;i<menuItems.length;i=i+1|0)this.SetWall(menuItems[i].pos.$clone(),!1);$t=Bridge.getEnumerator(levelMap);try{while($t.moveNext())tile=$t.Current,this.PlaceObject(tile,tile.objId,tile.objFacing),this.SetWall(tile.pos.$clone(),tile.wall)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}this.RebuildWallColliders()},ClearObjects:function(){var $t,tile;$t=Bridge.getEnumerator(this.levelMap);try{while($t.moveNext())tile=$t.Current,tile.DestroyObject()}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},Update:function(time){this.wallsDirty&&this.RebuildWallColliders()},GetObjectRect:function(id){for(var i=0;i<this.modes.length;i=i+1|0)if(this.modes[i].mode===CircuitCracker.Mode.Object&&this.modes[i].id===id)return this.modes[i].sprite.$clone();return Microsoft.Xna.Framework.Rectangle.Empty.$clone()},PlaceObject:function(tile,objId,facing){if(objId>=0&&objId<CircuitCracker.TilePlacer.objectTypes.length){tile.objId=objId;tile.objFacing=facing;switch(objId){case 0:return tile.obj=new CircuitCracker.LevelObjects.Door(tile,objId);case 1:return tile.obj=new CircuitCracker.LevelObjects.Plate(tile,objId);case 2:return tile.obj=new CircuitCracker.LevelObjects.Crate(tile,objId);case 3:return tile.obj=new CircuitCracker.LevelObjects.Player(tile,objId);case 4:return tile.obj=new CircuitCracker.LevelObjects.Goal(tile,objId);case 5:return tile.obj=new CircuitCracker.LevelObjects.Conveyor(tile,objId);case 6:return tile.obj=new CircuitCracker.LevelObjects.Spike(tile,objId);case 7:return tile.obj=new CircuitCracker.LevelObjects.Laser(tile,objId);case 8:return tile.obj=new CircuitCracker.LevelObjects.Detector(tile,objId);case 9:return tile.obj=new CircuitCracker.LevelObjects.MetalCrate(tile,objId);case 10:return tile.obj=new CircuitCracker.LevelObjects.InversePlayer(tile,objId);case 11:return tile.obj=new CircuitCracker.LevelObjects.WinBlock(tile,objId);case 12:return tile.obj=new CircuitCracker.LevelObjects.Teleporter(tile,objId);case 13:return tile.obj=new CircuitCracker.LevelObjects.Robot(tile,objId);case 14:return tile.obj=new CircuitCracker.LevelObjects.Piston(tile,objId);case 15:return tile.obj=new CircuitCracker.LevelObjects.LevelLink(tile,objId);case 16:return tile.obj=new CircuitCracker.LevelObjects.RobotSensor(tile,objId);case 17:return tile.obj=new CircuitCracker.LevelObjects.MessageBox(tile,objId);case 18:return tile.obj=new CircuitCracker.LevelObjects.Resetor(tile,objId)}}return null},RebuildWallColliders:function(){var $t,col,mask,i,y,x,width,height,j,n,y1,x1,done,pos,b;$t=Bridge.getEnumerator(this.wallColliders);try{while($t.moveNext())col=$t.Current,CircuitCracker.Game.world.RemoveBody(col)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}for(this.wallColliders.Clear(),mask=System.Array.init(Bridge.Int.mul(this.wallSizeX,this.wallSizeY),!1,System.Boolean),i=0,y=0;y<this.wallSizeY;y=y+1|0)for(x=0;x<this.wallSizeX;x=x+1|0)mask[i]=this.walls.get([x,y])>=0,i=i+1|0;for(n=0,y1=0;y1<this.wallSizeY;y1=y1+1|0)for(x1=0;x1<this.wallSizeX;)if(mask[n]){for(width=1;mask[n+width|0]&&(x1+width|0)<this.wallSizeX;width=width+1|0);for(done=!1,height=1;(y1+height|0)<this.wallSizeY;height=height+1|0){for(i=0;i<width;i=i+1|0)if(!mask[(n+i|0)+Bridge.Int.mul(height,this.wallSizeX)|0]){done=!0;break}if(done)break}for(pos=new Microsoft.Xna.Framework.Vector2.$ctor2(x1+width/2-1.5,y1+height/2-1.5),b=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,width,height,1,pos.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static,this),this.wallColliders.Push(b),j=0;j<height;j=j+1|0)for(i=0;i<width;i=i+1|0)mask[(n+i|0)+Bridge.Int.mul(j,this.wallSizeX)|0]=!1;x1=x1+width|0;n=n+width|0}else x1=x1+1|0,n=n+1|0;this.wallsDirty=!1},InitWalls:function(){for(var y,x=0;x<this.wallSizeX;x=x+1|0)for(y=0;y<this.wallSizeY;y=y+1|0)this.walls.set([x,y],-1);this.BuildRectangle(new Microsoft.Xna.Framework.Point.$ctor2(-1,-1),new Microsoft.Xna.Framework.Point.$ctor2(this.levelSize.X,this.levelSize.Y))},BuildRectangle:function(a,b){Microsoft.Xna.Framework.Point.op_Equality(a.$clone(),b.$clone())?this.SetWall(a.$clone(),!0):(this.ConnectWithWalls(a.$clone(),b.$clone()),this.ConnectWithWalls(b.$clone(),a.$clone()))},ConnectWithWalls:function(a,b){if(a.X<b.X)while(a.X<b.X)this.SetWall(a.$clone(),!0),a.X=a.X+1|0;else while(a.X>b.X)this.SetWall(a.$clone(),!0),a.X=a.X-1|0;if(a.Y<b.Y)while(a.Y<b.Y)this.SetWall(a.$clone(),!0),a.Y=a.Y+1|0;else while(a.Y>b.Y)this.SetWall(a.$clone(),!0),a.Y=a.Y-1|0},SetWall:function(pos,setToWall){var currentId=this.walls.get([pos.X+1|0,pos.Y+1|0]),wall,i,x,y,tile;if((setToWall||currentId!==-1)&&(!setToWall||!(currentId>=0))){for(wall=setToWall?0:-1,i=0;i<4;i=i+1|0)x=(pos.X+1|0)+this.dirs.get([i,0])|0,y=(pos.Y+1|0)+this.dirs.get([i,1])|0,x>=0&&x<this.wallSizeX&&y>=0&&y<this.wallSizeY&&this.walls.get([x,y])>=0&&(setToWall?(wall=wall|1<<i,this.walls.set([x,y],this.walls.get([x,y])|1<<this.oppDirs[i])):this.walls.set([x,y],this.walls.get([x,y])&~(1<<this.oppDirs[i])));this.walls.set([pos.X+1|0,pos.Y+1|0],wall);pos.X>=0&&pos.X<this.levelSize.X&&pos.Y>=0&&pos.Y<this.levelSize.Y&&(tile=this.levelMap.get([pos.X,pos.Y]),tile.DestroyObject(),tile.wall=setToWall);this.wallsDirty=!0}}}});Bridge.define("CircuitCracker.UI.AnchorX",{$kind:"enum",statics:{fields:{Left:0,Center:1,Right:2,Stretch:3}}});Bridge.define("CircuitCracker.UI.AnchorY",{$kind:"enum",statics:{fields:{Top:0,Center:1,Bottom:2,Stretch:3}}});Bridge.define("CircuitCracker.UI.ISelectable",{$kind:"interface"});Bridge.define("CircuitCracker.UI.UIElement",{statics:{fields:{root:null,lastHovered:null,hovered:null,tf:null,mouseCaptured:!1},ctors:{init:function(){this.tf=new Microsoft.Xna.Framework.Matrix},ctor:function(){CircuitCracker.UI.UIElement.root=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.Panel,new CircuitCracker.UI.Panel.$ctor1(Microsoft.Xna.Framework.Color.Transparent.$clone()),CircuitCracker.UI.AnchorX.Stretch,CircuitCracker.UI.AnchorY.Stretch);CircuitCracker.UI.UIElement.root.blocksMouse=!1;CircuitCracker.UI.UIElement.tf=Microsoft.Xna.Framework.Matrix.CreateTranslation$1(.5,.5,0)}},methods:{IsMouseOverUI:function(){return CircuitCracker.UI.UIElement.hovered!=null},RootRect:function(){return CircuitCracker.UI.UIElement.root.rect.$clone()},UpdateAll:function(deltaTime){var lh,h,s;CircuitCracker.UI.UIElement.lastHovered=CircuitCracker.UI.UIElement.hovered;CircuitCracker.UI.UIElement.hovered=null;CircuitCracker.UI.UIElement.root.Update(deltaTime);Bridge.referenceEquals(CircuitCracker.UI.UIElement.lastHovered,CircuitCracker.UI.UIElement.hovered)||((lh=Bridge.as(CircuitCracker.UI.UIElement.lastHovered,CircuitCracker.UI.ISelectable))!=null&&lh.CircuitCracker$UI$ISelectable$PointerExit(),(h=Bridge.as(CircuitCracker.UI.UIElement.hovered,CircuitCracker.UI.ISelectable))!=null&&h.CircuitCracker$UI$ISelectable$PointerEnter());(s=Bridge.as(CircuitCracker.UI.UIElement.hovered,CircuitCracker.UI.ISelectable))!=null&&CircuitCracker.UI.UIElement.hovered.UpdateHovered(s)},RenderAll:function(spriteBatch,tex,view){spriteBatch.Begin(0,void 0,void 0,void 0,void 0,void 0,CircuitCracker.UI.UIElement.tf);CircuitCracker.UI.UIElement.root.RenderBase(spriteBatch,tex,view.$clone());spriteBatch.End()}}},fields:{margin:0,parent:null,children:null,rect:null,position:null,anchorX:0,anchorY:0,visible:!1,blocksMouse:!1,selectStart:!1},props:{Visible:{get:function(){return this.visible}}},ctors:{init:function(){this.rect=new Microsoft.Xna.Framework.Rectangle;this.position=new Microsoft.Xna.Framework.Point;this.children=new(System.Collections.Generic.List$1(CircuitCracker.UI.UIElement).ctor);this.visible=!0;this.blocksMouse=!0},ctor:function(){this.$initialize();this.parent=CircuitCracker.UI.UIElement.root;CircuitCracker.UI.UIElement.root!=null&&CircuitCracker.UI.UIElement.root.children.add(this)},$ctor1:function(children){var $t,child;if(CircuitCracker.UI.UIElement.ctor.call(this),children!=null){$t=Bridge.getEnumerator(children);try{while($t.moveNext())child=$t.Current,child.SetParent(this)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}}}},methods:{UpdateHovered:function(selectable){CircuitCracker.Input.GetButtonDown(CircuitCracker.MouseButton.Left)&&(selectable.CircuitCracker$UI$ISelectable$PointerDown(),this.selectStart=!0,CircuitCracker.UI.UIElement.mouseCaptured=!0);this.selectStart&&CircuitCracker.Input.GetButtonUp(CircuitCracker.MouseButton.Left)&&(this.rect.Contains(CircuitCracker.Input.GetMousePosition())&&selectable.CircuitCracker$UI$ISelectable$Select(),selectable.CircuitCracker$UI$ISelectable$PointerUp(),this.selectStart=!1,CircuitCracker.UI.UIElement.mouseCaptured=!1);this.selectStart&&selectable.CircuitCracker$UI$ISelectable$Drag()},Update:function(deltaTime){(this.selectStart||!CircuitCracker.UI.UIElement.mouseCaptured&&this.blocksMouse&&this.rect.Contains(CircuitCracker.Input.GetMousePosition()))&&(CircuitCracker.UI.UIElement.hovered=this);for(var i=0;i<this.children.Count;i=i+1|0)this.children.getItem(i).visible&&this.children.getItem(i).Update(deltaTime)},RenderBase:function(spriteBatch,tex,view){if(this.visible){this.CalcRect(view.$clone());this.Render(spriteBatch,tex);for(var i=0;i<this.children.Count;i=i+1|0)this.children.getItem(i).RenderBase(spriteBatch,tex,this.rect.$clone())}},CalcRect:function(view){var w,h;this.rect=new Microsoft.Xna.Framework.Rectangle.$ctor1(Microsoft.Xna.Framework.Point.op_Addition(view.Location.$clone(),this.position.$clone()),new Microsoft.Xna.Framework.Point.$ctor2(this.Width(),this.Height()));switch(this.anchorX){case CircuitCracker.UI.AnchorX.Left:this.rect.X=this.rect.X+this.margin|0;break;case CircuitCracker.UI.AnchorX.Center:this.rect.X=this.rect.X+(Bridge.Int.div(view.Width-this.rect.Width|0,2)|0)|0;break;case CircuitCracker.UI.AnchorX.Right:this.rect.X=this.rect.X+((view.Width-this.rect.Width|0)-this.margin|0)|0;break;case CircuitCracker.UI.AnchorX.Stretch:this.rect.X=this.rect.X+this.margin|0;w=view.Width-Bridge.Int.mul(2,this.margin)|0;this.rect.Width<w&&(this.rect.Width=w);break}switch(this.anchorY){case CircuitCracker.UI.AnchorY.Top:this.rect.Y=this.rect.Y+this.margin|0;break;case CircuitCracker.UI.AnchorY.Center:this.rect.Y=this.rect.Y+(Bridge.Int.div(view.Height-this.rect.Height|0,2)|0)|0;break;case CircuitCracker.UI.AnchorY.Bottom:this.rect.Y=this.rect.Y+((view.Height-this.rect.Height|0)-this.margin|0)|0;break;case CircuitCracker.UI.AnchorY.Stretch:this.rect.Y=this.rect.Y+this.margin|0;h=view.Height-Bridge.Int.mul(2,this.margin)|0;this.rect.Height<h&&(this.rect.Height=h);break}},SetParent:function(element){element==null&&(element=CircuitCracker.UI.UIElement.root);this.parent.children.remove(this);this.parent=element;this.parent.children.add(this)},SetPosition:function(position){this.position=position.$clone()},SetAnchors:function(anchorX,anchorY){this.anchorX=anchorX;this.anchorY=anchorY},SetVisible:function(visible){this.visible=visible},Remove:function(){this.parent.children.remove(this)}}});Bridge.define("CircuitCracker.UI.CommonUI",{statics:{fields:{queue:null,callback:null,duration:0,showing:!1,blocker:null,title:null,tooltip:null,imageTooltip:null,imageTooltipText:null,imageTooltipImage:null,dialogBox:null,dialogBoxText:null},ctors:{init:function(){this.queue=new(System.Collections.Generic.Queue$1(CircuitCracker.UI.CommonUI.QueueData).ctor)}},methods:{Init:function(){CircuitCracker.UI.CommonUI.blocker=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.Panel,new CircuitCracker.UI.Panel.$ctor1(new Microsoft.Xna.Framework.Color.$ctor2(Microsoft.Xna.Framework.Color.Black.$clone(),.4)),CircuitCracker.UI.AnchorX.Stretch,CircuitCracker.UI.AnchorY.Stretch);CircuitCracker.UI.CommonUI.blocker.SetVisible(!1);CircuitCracker.UI.CommonUI.title=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.$ctor1("",!0),CircuitCracker.UI.AnchorX.Center,CircuitCracker.UI.AnchorY.Center);CircuitCracker.UI.CommonUI.title.SetVisible(!1);CircuitCracker.UI.CommonUI.tooltip=new CircuitCracker.UI.TextBox.$ctor1("");CircuitCracker.UI.CommonUI.tooltip.SetVisible(!1);CircuitCracker.UI.CommonUI.imageTooltipText=CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.TextBox,new CircuitCracker.UI.TextBox.$ctor1(""),CircuitCracker.UI.AnchorX.Stretch);CircuitCracker.UI.CommonUI.imageTooltipImage=CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.Image,new CircuitCracker.UI.Image.$ctor2(CircuitCracker.Sprites.None.$clone(),Microsoft.Xna.Framework.Color.White.$clone()),CircuitCracker.UI.AnchorX.Stretch);CircuitCracker.UI.CommonUI.imageTooltip=new CircuitCracker.UI.VerticalLayout(0,[CircuitCracker.UI.CommonUI.imageTooltipText,CircuitCracker.UI.CommonUI.imageTooltipImage]);CircuitCracker.UI.CommonUI.imageTooltip.SetVisible(!1);CircuitCracker.UI.CommonUI.dialogBoxText=new CircuitCracker.UI.TextBox.$ctor1("");CircuitCracker.UI.CommonUI.dialogBox=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.VerticalLayout,new CircuitCracker.UI.VerticalLayout(5,[CircuitCracker.UI.CommonUI.dialogBoxText,CircuitCracker.UI.UIBuilder.Anchor(Bridge.global.CircuitCracker.UI.Button,new CircuitCracker.UI.Button("Ok",CircuitCracker.UI.CommonUI.CloseDialogBox),CircuitCracker.UI.AnchorX.Right)]),CircuitCracker.UI.AnchorX.Center,CircuitCracker.UI.AnchorY.Center);CircuitCracker.UI.CommonUI.dialogBox.SetVisible(!1)},ShowTooltip:function(text,position){CircuitCracker.UI.CommonUI.tooltip.SetText(text);CircuitCracker.UI.CommonUI.tooltip.SetPosition(position.$clone());CircuitCracker.UI.CommonUI.tooltip.SetVisible(!0)},HideTooltip:function(){CircuitCracker.UI.CommonUI.tooltip.SetVisible(!1);CircuitCracker.UI.CommonUI.imageTooltip.SetVisible(!1)},ShowImageTooltip:function(text,texture,sourceRect,pos,altY){CircuitCracker.UI.CommonUI.imageTooltipText.SetText(text);CircuitCracker.UI.CommonUI.imageTooltipImage.SetImage(texture,sourceRect.$clone(),Microsoft.Xna.Framework.Color.White.$clone());var root=CircuitCracker.UI.UIElement.RootRect();pos.X=pos.X-Math.max(0,(pos.X+CircuitCracker.UI.CommonUI.imageTooltip.Width()|0)-root.Width|0)|0;(pos.Y+CircuitCracker.UI.CommonUI.imageTooltip.Height()|0)>root.Height&&(pos.Y=altY-CircuitCracker.UI.CommonUI.imageTooltip.Height()|0);CircuitCracker.UI.CommonUI.imageTooltip.SetPosition(pos.$clone());CircuitCracker.UI.CommonUI.imageTooltip.SetVisible(!0)},ShowBlocker:function(){CircuitCracker.UI.CommonUI.blocker.SetVisible(!0)},HideBlocker:function(){CircuitCracker.UI.CommonUI.showing||CircuitCracker.UI.CommonUI.blocker.SetVisible(!1)},ShowTitle:function(text,duration,callback){CircuitCracker.UI.CommonUI.queue.Enqueue(new CircuitCracker.UI.CommonUI.QueueData(text,callback,CircuitCracker.UI.CommonUI.QueueType.Title,duration));CircuitCracker.UI.CommonUI.TryShow()},ShowDialogBox:function(text,callback){CircuitCracker.UI.CommonUI.queue.Enqueue(new CircuitCracker.UI.CommonUI.QueueData(text,callback,CircuitCracker.UI.CommonUI.QueueType.DialogBox));CircuitCracker.UI.CommonUI.TryShow()},CloseDialogBox:function(){CircuitCracker.UI.CommonUI.dialogBox.SetVisible(!1);Bridge.staticEquals(CircuitCracker.UI.CommonUI.callback,null)?null:CircuitCracker.UI.CommonUI.callback();CircuitCracker.UI.CommonUI.ShowNext()},TryShow:function(){CircuitCracker.UI.CommonUI.showing||(CircuitCracker.UI.CommonUI.showing=!0,CircuitCracker.UI.CommonUI.blocker.SetVisible(!0),CircuitCracker.Game.paused=!0,CircuitCracker.UI.CommonUI.ShowNext())},ShowNext:function(){if(CircuitCracker.UI.CommonUI.queue.Count>0){var data=CircuitCracker.UI.CommonUI.queue.Dequeue();CircuitCracker.UI.CommonUI.callback=data.callback;switch(data.type){case CircuitCracker.UI.CommonUI.QueueType.DialogBox:CircuitCracker.GameContent.SoundEffects.message.Play();CircuitCracker.UI.CommonUI.dialogBoxText.SetText(data.text);CircuitCracker.UI.CommonUI.dialogBox.SetVisible(!0);break;case CircuitCracker.UI.CommonUI.QueueType.Title:CircuitCracker.UI.CommonUI.title.SetText(data.text,!0);CircuitCracker.UI.CommonUI.title.SetVisible(!0);CircuitCracker.UI.CommonUI.duration=data.duration;break}}else CircuitCracker.UI.CommonUI.showing=!1,CircuitCracker.UI.CommonUI.blocker.SetVisible(!1),CircuitCracker.Game.paused=!1},Update:function(deltaTime){CircuitCracker.UI.CommonUI.duration>0&&(CircuitCracker.UI.CommonUI.duration-=deltaTime,CircuitCracker.UI.CommonUI.duration<=0&&(CircuitCracker.UI.CommonUI.title.SetVisible(!1),Bridge.staticEquals(CircuitCracker.UI.CommonUI.callback,null)?null:CircuitCracker.UI.CommonUI.callback(),CircuitCracker.UI.CommonUI.ShowNext()));CircuitCracker.UI.CommonUI.dialogBox.Visible&&CircuitCracker.Input.GetButtonDown$2(Microsoft.Xna.Framework.Input.Keys.Enter)&&CircuitCracker.UI.CommonUI.CloseDialogBox()}}}});Bridge.define("CircuitCracker.UI.CommonUI.QueueData",{$kind:"nested class",fields:{callback:null,type:0,text:null,duration:0},ctors:{ctor:function(text,callback,type,duration){duration===void 0&&(duration=0);this.$initialize();this.text=text;this.callback=callback;this.type=type;this.duration=duration}}});Bridge.define("CircuitCracker.UI.CommonUI.QueueType",{$kind:"nested enum",statics:{fields:{DialogBox:0,Title:1}}});Bridge.define("CircuitCracker.UI.Thickness",{$kind:"struct",statics:{fields:{zero:null},props:{Zero:{get:function(){return CircuitCracker.UI.Thickness.zero.$clone()}}},ctors:{init:function(){this.zero=new CircuitCracker.UI.Thickness;this.zero=new CircuitCracker.UI.Thickness.$ctor1(0)}},methods:{op_Addition:function(a,b){var result=a.$clone();return result.X=result.X-b.Left|0,result.Y=result.Y-b.Top|0,result.Width=result.Width+b.Width|0,result.Height=result.Height+b.Height|0,result.$clone()},op_Subtraction:function(a,b){var result=a.$clone();return result.X=result.X+b.Left|0,result.Y=result.Y+b.Top|0,result.Width=result.Width-b.Width|0,result.Width<0&&(result.Width=0),result.Height=result.Height-b.Height|0,result.Height<0&&(result.Height=0),result.$clone()},getDefaultValue:function(){return new CircuitCracker.UI.Thickness}}},fields:{Top:0,Right:0,Bottom:0,Left:0},props:{Width:{get:function(){return this.Left+this.Right|0}},Height:{get:function(){return this.Top+this.Bottom|0}}},ctors:{$ctor1:function(value){CircuitCracker.UI.Thickness.$ctor3.call(this,value,value,value,value)},$ctor2:function(topBottom,leftRight){CircuitCracker.UI.Thickness.$ctor3.call(this,topBottom,leftRight,topBottom,leftRight)},$ctor3:function(top,right,bottom,left){this.$initialize();this.Top=top;this.Right=right;this.Bottom=bottom;this.Left=left},ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return Bridge.addHash([3603879730,this.Top,this.Right,this.Bottom,this.Left])},equals:function(o){return Bridge.is(o,CircuitCracker.UI.Thickness)?Bridge.equals(this.Top,o.Top)&&Bridge.equals(this.Right,o.Right)&&Bridge.equals(this.Bottom,o.Bottom)&&Bridge.equals(this.Left,o.Left):!1},$clone:function(to){var s=to||new CircuitCracker.UI.Thickness;return s.Top=this.Top,s.Right=this.Right,s.Bottom=this.Bottom,s.Left=this.Left,s}}});Bridge.define("CircuitCracker.UI.UIBuilder",{statics:{methods:{Anchors:function(T,element,x,y){return element.SetAnchors(x,y),element},Anchor:function(T,element,x){return element.SetAnchors(x,CircuitCracker.UI.AnchorY.Top),element},Anchor$1:function(T,element,y){return element.SetAnchors(CircuitCracker.UI.AnchorX.Left,y),element},Position:function(T,element,position){return element.SetPosition(position.$clone()),element},BackgroundColor:function(T,panel,color){return panel.SetBackgroundColor(color.$clone()),panel}}}});Bridge.define("CircuitCracker.Utilities",{statics:{methods:{Swap:function(T,a,b){var temp=a.v;a.v=b.v;b.v=temp},Clamp:function(value,min,max){return value<min?min:value>max?max:value},Clamp$1:function(value,min,max){return value<min?min:value>max?max:value},LoopValue:function(value,max){if(max===0)return 0;if(value>=max)return value-max|0;else if(value<0)return value+max|0;return value},ConstructOctogonal:function(x,y){x={v:x};y={v:y};x.v=Math.abs(x.v);y.v=Math.abs(y.v);x.v<y.v&&CircuitCracker.Utilities.Swap(System.Single,x,y);return System.Array.init([new Microsoft.Xna.Framework.Vector2.$ctor2(x.v,y.v),new Microsoft.Xna.Framework.Vector2.$ctor2(y.v,x.v),new Microsoft.Xna.Framework.Vector2.$ctor2(-y.v,x.v),new Microsoft.Xna.Framework.Vector2.$ctor2(-x.v,y.v),new Microsoft.Xna.Framework.Vector2.$ctor2(-x.v,-y.v),new Microsoft.Xna.Framework.Vector2.$ctor2(-y.v,-x.v),new Microsoft.Xna.Framework.Vector2.$ctor2(y.v,-x.v),new Microsoft.Xna.Framework.Vector2.$ctor2(x.v,-y.v)],Microsoft.Xna.Framework.Vector2)}}}});Bridge.define("CircuitCracker.WireLogic",{statics:{fields:{signalRange:0,nDirs:0},ctors:{init:function(){this.signalRange=1e3;this.nDirs=4}}},fields:{levelMap:null,dirs:null,oppDirs:null},ctors:{init:function(){this.dirs=System.Array.create(0,[[0,-1],[1,0],[0,1],[-1,0]],System.Int32,4,2);this.oppDirs=System.Array.init([2,3,0,1],System.Int32)}},methods:{InitWireLogic:function(levelMap){this.levelMap=levelMap},ResetLogic:function(){var $t,tile;if(this.levelMap!=null){$t=Bridge.getEnumerator(this.levelMap);try{while($t.moveNext())tile=$t.Current,System.Array.fill(tile.signalStrength,0,0,4)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}}},UpdateWires:function(){var $t,$t1,$t2,$t3,$t4,$t5,$t6,$t7,tile,d,l,tile1,l1,tile2,d1,l2,tile3;$t=Bridge.getEnumerator(this.levelMap);try{while($t.moveNext())if(tile=$t.Current,tile.wire!==0)for(System.Array.fill(tile.minNearStrength,0,0,4),d=0;d<CircuitCracker.WireLogic.nDirs;d=d+1|0)if(l=tile.GetWireLayer(d),l!==-1){var x=tile.pos.$clone().X+this.dirs.get([d,0])|0,y=tile.pos.$clone().Y+this.dirs.get([d,1])|0,sigStr=($t1=this.levelMap.get([x,y]).signalStrength)[this.levelMap.get([x,y]).GetWireLayer(this.oppDirs[d])];sigStr!==0&&(tile.minNearStrength[l]===0||sigStr<tile.minNearStrength[l])&&(tile.minNearStrength[l]=sigStr)}}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}$t2=Bridge.getEnumerator(this.levelMap);try{while($t2.moveNext())if(tile1=$t2.Current,tile1.wire!==0){for(l1=0;l1<4;l1=l1+1|0)tile1.nextStrength[l1]=tile1.signalStrength[l1]>tile1.minNearStrength[l1]&&tile1.minNearStrength[l1]>0?tile1.minNearStrength[l1]+1|0:0;switch(tile1.gate){case CircuitCracker.Gate.Not:tile1.signalStrength[1]<=0&&(tile1.nextStrength[0]=1);break;case CircuitCracker.Gate.And:(tile1.signalStrength[1]>0||tile1.GetTmpLayer(1)===0)&&(tile1.signalStrength[2]>0||tile1.GetTmpLayer(2)===0)&&(tile1.signalStrength[3]>0||tile1.GetTmpLayer(3)===0)&&(tile1.nextStrength[0]=1);break;case CircuitCracker.Gate.Or:(tile1.signalStrength[1]>0||tile1.signalStrength[2]>0||tile1.signalStrength[3]>0)&&(tile1.nextStrength[0]=1);break;case CircuitCracker.Gate.Xor:tile1.signalStrength[1]>0!=tile1.signalStrength[2]>0!=tile1.signalStrength[3]>0&&(tile1.nextStrength[0]=1);break;case CircuitCracker.Gate.Toggle:tile1.signalStrength[0]===1&&(tile1.nextStrength[0]=1);break}tile1.source&&(tile1.nextStrength[0]=1,tile1.nextStrength[1]=1,tile1.nextStrength[2]=1,tile1.nextStrength[3]=1)}}finally{Bridge.is($t2,System.IDisposable)&&$t2.System$IDisposable$Dispose()}$t3=Bridge.getEnumerator(this.levelMap);try{while($t3.moveNext())if(tile2=$t3.Current,tile2.wire!==0){for(d1=0;d1<CircuitCracker.WireLogic.nDirs;d1=d1+1|0)if(l2=tile2.GetWireLayer(d1),l2!==-1&&tile2.signalStrength[l2]===0&&tile2.nextStrength[l2]===0){var x1=tile2.pos.$clone().X+this.dirs.get([d1,0])|0,y1=tile2.pos.$clone().Y+this.dirs.get([d1,1])|0,dLayer=this.levelMap.get([x1,y1]).GetWireLayer(this.oppDirs[d1]);($t4=this.levelMap.get([x1,y1]).signalStrength)[dLayer]!==0&&($t5=this.levelMap.get([x1,y1]).signalStrength)[dLayer]===($t6=this.levelMap.get([x1,y1]).nextStrength)[dLayer]&&tile2.minNearStrength[l2]<CircuitCracker.WireLogic.signalRange&&(tile2.nextStrength[l2]=tile2.minNearStrength[l2]+1|0)}tile2.gate===CircuitCracker.Gate.Toggle&&tile2.signalStrength[1]===0&&tile2.nextStrength[1]!==0&&(tile2.nextStrength[0]=tile2.nextStrength[0]===1?0:1)}}finally{Bridge.is($t3,System.IDisposable)&&$t3.System$IDisposable$Dispose()}$t7=Bridge.getEnumerator(this.levelMap);try{while($t7.moveNext())(tile3=$t7.Current,tile3.wire!==0)&&System.Array.copy(tile3.nextStrength,0,tile3.signalStrength,0,4)}finally{Bridge.is($t7,System.IDisposable)&&$t7.System$IDisposable$Dispose()}}}});Bridge.define("CircuitCracker.LevelButton",{inherits:[CircuitCracker.LevelObjects.IClickable,CircuitCracker.LevelObjects.IHoverable],fields:{pos:null,collider:null,sprite:null,tooltip:null,disabled:!1,hovering:!1,onClick:null,onEnter:null,onExit:null},alias:["OnClick","CircuitCracker$LevelObjects$IClickable$OnClick","OnMouseEnter","CircuitCracker$LevelObjects$IHoverable$OnMouseEnter","OnMouseExit","CircuitCracker$LevelObjects$IHoverable$OnMouseExit"],ctors:{init:function(){this.pos=new Microsoft.Xna.Framework.Point},ctor:function(pos,rect,tooltip,onClick,onEnter,onExit){onEnter===void 0&&(onEnter=null);onExit===void 0&&(onExit=null);this.$initialize();this.pos=pos.$clone();var p=new Microsoft.Xna.Framework.Vector2.$ctor2(pos.X,pos.Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,1,1,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static,this);this.sprite=new CircuitCracker.Sprite.ctor(rect.$clone(),pos.$clone(),0,1);this.tooltip=tooltip;this.onClick=onClick;this.onEnter=onEnter;this.onExit=onExit}},methods:{SetSpriteRect:function(rect){this.sprite.rect=rect.$clone()},SetDisabled:function(disabled){this.disabled!==disabled&&(this.hovering&&(this.OnMouseExit(),this.disabled=disabled,this.OnMouseEnter()),this.disabled=disabled)},Destroy:function(){CircuitCracker.Game.world.RemoveBody(this.collider);this.sprite.Remove()},OnClick:function(){this.disabled||(Bridge.staticEquals(this.onClick,null)?null:this.onClick())},OnMouseEnter:function(){if(this.hovering=!0,this.disabled)Microsoft.Xna.Framework.Input.Mouse.SetCursor(Microsoft.Xna.Framework.Input.MouseCursor.No);else{if(Microsoft.Xna.Framework.Input.Mouse.SetCursor(Microsoft.Xna.Framework.Input.MouseCursor.Hand),this.sprite.color=Microsoft.Xna.Framework.Color.op_Multiply(this.sprite.color.$clone(),.5),this.tooltip!=null){var v=CircuitCracker.LevelRenderer.WorldToScreenPos(Microsoft.Xna.Framework.Vector2.op_Addition(this.pos.ToVector2(),new Microsoft.Xna.Framework.Vector2.$ctor2(-.5,.75)));CircuitCracker.UI.CommonUI.ShowTooltip(this.tooltip,v.ToPoint())}Bridge.staticEquals(this.onEnter,null)?null:this.onEnter()}},OnMouseExit:function(){this.hovering=!1;Microsoft.Xna.Framework.Input.Mouse.SetCursor(Microsoft.Xna.Framework.Input.MouseCursor.Arrow);this.disabled||(CircuitCracker.UI.CommonUI.HideTooltip(),this.sprite.color=Microsoft.Xna.Framework.Color.White.$clone(),Bridge.staticEquals(this.onExit,null)?null:this.onExit())}}});Bridge.define("CircuitCracker.LevelObjects.Conveyor",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{speed:0,nSoundsActive:0},ctors:{init:function(){this.speed=2}}},fields:{moveables:null,direction:null,movedSprite:null,soundActive:!1},ctors:{init:function(){this.direction=new Microsoft.Xna.Framework.Vector2;this.movedSprite=new Microsoft.Xna.Framework.Rectangle;this.moveables=new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.Moveable).ctor)},ctor:function(placedOn,id){var r,p;this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.Conveyor.$clone());r=placedOn.objFacing*CircuitCracker.LevelObjects.LevelObject.facing2rad;this.direction=this.FacingDirection();p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,.5,.9,1,p.$clone(),r,VelcroPhysics.Dynamics.BodyType.Static);this.collider.IsSensor=!0;this.collider.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.collider.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparation));this.movedSprite=CircuitCracker.Sprites.Conveyor.$clone()}},methods:{Reset:function(){this.SoundOff();this.sprite.rect=CircuitCracker.Sprites.Conveyor.$clone();this.movedSprite=CircuitCracker.Sprites.Conveyor.$clone()},Destroy:function(){this.SoundOff();CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){for(var $t,i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.Move();this.SoundOn();return}this.SoundOff()},Move:function(){var $t,m,y;$t=Bridge.getEnumerator(this.moveables);try{while($t.moveNext())m=$t.Current,m==null?this.moveables.remove(m):(m.conveyorDirection=Microsoft.Xna.Framework.Vector2.op_Addition(m.conveyorDirection.$clone(),this.direction.$clone()),Bridge.Int.clip32(m.position.X+.5)===this.placedOn.pos.$clone().X&&Bridge.Int.clip32(m.position.Y+.5)===this.placedOn.pos.$clone().Y&&(m.onActiveConveyor=!0))}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}y=this.movedSprite.Y;y=y>=192?160:y+1|0;this.movedSprite.Y=y;this.sprite.rect=this.movedSprite.$clone()},OnCollision:function(fixtureA,fixtureB,contact){var moveable;(moveable=Bridge.as(fixtureB.Body.UserData,CircuitCracker.LevelObjects.Moveable))!=null&&this.moveables.add(moveable)},OnSeparation:function(fixtureA,fixtureB,contact){var moveable;(moveable=Bridge.as(fixtureB.Body.UserData,CircuitCracker.LevelObjects.Moveable))!=null&&this.moveables.remove(moveable)},SoundOn:function(){if(!this.soundActive){var volume=CircuitCracker.LevelObjects.Conveyor.nSoundsActive<64?.1+CircuitCracker.LevelObjects.Conveyor.nSoundsActive/80:.9;CircuitCracker.LevelObjects.Conveyor.nSoundsActive=CircuitCracker.LevelObjects.Conveyor.nSoundsActive+1|0;this.soundActive=!0}},SoundOff:function(){if(this.soundActive){var volume=CircuitCracker.LevelObjects.Conveyor.nSoundsActive<64?.1+CircuitCracker.LevelObjects.Conveyor.nSoundsActive/80:.9;CircuitCracker.LevelObjects.Conveyor.nSoundsActive=CircuitCracker.LevelObjects.Conveyor.nSoundsActive-1|0;CircuitCracker.LevelObjects.Conveyor.nSoundsActive===0;this.soundActive=!1}}}});Bridge.define("CircuitCracker.LevelObjects.Moveable",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{movedir:null,speedModifier:0,virtualGamepad:null,sprinting:!1,maxEffect:0},ctors:{init:function(){this.movedir=new Microsoft.Xna.Framework.Vector2;this.virtualGamepad=new Microsoft.Xna.Framework.Point;this.movedir=Microsoft.Xna.Framework.Vector2.Zero.$clone();this.speedModifier=1;this.maxEffect=16}},methods:{Update:function(){var p,compass;if(CircuitCracker.Game.TouchInput)if(CircuitCracker.Input.GetButtonDown(CircuitCracker.MouseButton.Left)&&(CircuitCracker.LevelObjects.Moveable.virtualGamepad=CircuitCracker.Input.GetMousePosition()),p=Microsoft.Xna.Framework.Point.op_Subtraction(CircuitCracker.LevelObjects.Moveable.virtualGamepad.$clone(),CircuitCracker.Input.GetMousePosition()).ToVector2(),CircuitCracker.Input.GetButton(CircuitCracker.MouseButton.Left)&&p.LengthSquared()>625){CircuitCracker.LevelObjects.Moveable.sprinting=p.LengthSquared()>2500;compass=(Bridge.Int.clip32(Bridge.Math.round(Math.atan2(-p.Y,p.X)/.78539816339744828,0,6))+8|0)%8;switch(compass){case 0:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(-1,0);break;case 1:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(-1,1);break;case 2:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(0,1);break;case 3:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(1,1);break;case 4:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(1,0);break;case 5:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(1,-1);break;case 6:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(0,-1);break;case 7:CircuitCracker.LevelObjects.Moveable.movedir=new Microsoft.Xna.Framework.Vector2.$ctor2(-1,-1);break}}else CircuitCracker.LevelObjects.Moveable.movedir=Microsoft.Xna.Framework.Vector2.Zero.$clone();else{var keysDown=CircuitCracker.Input.GetButtonDown$2(Microsoft.Xna.Framework.Input.Keys.Space)||CircuitCracker.Input.GetButtonDown$2(Microsoft.Xna.Framework.Input.Keys.LeftShift),keys=CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.Space)||CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.LeftShift),mode=CircuitCracker.Game.settings.sprintMode;mode===2&&keysDown?CircuitCracker.LevelObjects.Moveable.sprinting=!CircuitCracker.LevelObjects.Moveable.sprinting:mode!==2&&(CircuitCracker.LevelObjects.Moveable.sprinting=keys^mode===1);CircuitCracker.LevelObjects.Moveable.speedModifier=CircuitCracker.LevelObjects.Moveable.sprinting?1:.6;CircuitCracker.LevelObjects.Moveable.movedir.X=CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.A)||CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.Left)?-1:0;CircuitCracker.LevelObjects.Moveable.movedir.X+=(CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.D)||CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.Right)?1:0)|0;CircuitCracker.LevelObjects.Moveable.movedir.Y=CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.W)||CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.Up)?-1:0;CircuitCracker.LevelObjects.Moveable.movedir.Y+=(CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.S)||CircuitCracker.Input.GetButton$2(Microsoft.Xna.Framework.Input.Keys.Down)?1:0)|0}CircuitCracker.LevelObjects.Moveable.speedModifier=CircuitCracker.LevelObjects.Moveable.sprinting?1:.6}}},fields:{position:null,conveyorDirection:null,onActiveConveyor:!1,Pushable:!1,defaultShader:0,callback:null,effect:0,x:0,y:0,radius:0},ctors:{init:function(){this.position=new Microsoft.Xna.Framework.Vector2;this.conveyorDirection=new Microsoft.Xna.Framework.Vector2},ctor:function(placedOn,id,rect,verts,density){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,rect);var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreatePolygon(CircuitCracker.Game.world,verts,density,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Dynamic,this);this.collider.LinearDamping=25;this.collider.FixedRotation=!0;this.collider.Friction=0}},methods:{SetTransform:function(pos,facing){this.SetTransform$1(new Microsoft.Xna.Framework.Vector2.$ctor2(pos.X,pos.Y),facing*CircuitCracker.LevelObjects.LevelObject.facing2rad)},SetTransform$1:function(position,rotation){this.position=position.$clone();this.collider.SetTransform(position.$clone(),rotation);this.sprite.position=position.$clone();this.sprite.rotation=rotation},Reset:function(){this.SetTransform(this.placedOn.pos.$clone(),this.placedOn.objFacing);this.collider.Enabled=!1;this.collider.Awake=!1;this.effect=0;this.sprite.color=Microsoft.Xna.Framework.Color.White.$clone();this.sprite.SetShader(this.defaultShader);this.sprite.SetEnabled(!0);CircuitCracker.LevelObjects.LevelObject.prototype.Reset.call(this)},Enable:function(){this.collider.Enabled=!0;CircuitCracker.LevelObjects.LevelObject.prototype.Enable.call(this)},FixedUpdate:function(){if(this.effect>0){this.sprite.color=new Microsoft.Xna.Framework.Color.$ctor9(this.x,this.y,this.radius,1-this.effect/CircuitCracker.LevelObjects.Moveable.maxEffect);this.effect===CircuitCracker.LevelObjects.Moveable.maxEffect?this.collider.Enabled=!1:this.effect===1&&(this.enabled=!1,this.sprite.SetEnabled(!1));this.effect=this.effect-1|0;return}else if(this.effect<0){this.sprite.color=new Microsoft.Xna.Framework.Color.$ctor9(this.x,this.y,this.radius,1- -this.effect/CircuitCracker.LevelObjects.Moveable.maxEffect);this.effect===-1&&(Bridge.staticEquals(this.callback,null)?null:this.callback(),this.sprite.color=Microsoft.Xna.Framework.Color.White.$clone(),this.sprite.SetShader(this.defaultShader));this.effect=this.effect+1|0;return}this.onActiveConveyor&&(Microsoft.Xna.Framework.Vector2.op_Inequality(this.conveyorDirection.$clone(),Microsoft.Xna.Framework.Vector2.Zero.$clone())&&(this.conveyorDirection=Microsoft.Xna.Framework.Vector2.op_Multiply$1(Microsoft.Xna.Framework.Vector2.op_Multiply$1(Microsoft.Xna.Framework.Vector2.Normalize(this.conveyorDirection.$clone()),CircuitCracker.LevelObjects.Conveyor.speed),CircuitCracker.LevelObjects.Moveable.speedModifier),this.collider.LinearVelocity=Microsoft.Xna.Framework.Vector2.op_Addition(this.collider.LinearVelocity.$clone(),this.conveyorDirection.$clone())),this.onActiveConveyor=!1);this.conveyorDirection=Microsoft.Xna.Framework.Vector2.Zero.$clone();this.position=this.collider.Position.$clone();this.sprite.position=this.position.$clone()},Dissolve:function(radius){this.sprite.SetShader(CircuitCracker.Shader.Dissolve);this.effect=CircuitCracker.LevelObjects.Moveable.maxEffect;this.SetShaderParams(radius)},Materialize:function(radius,callback){callback===void 0&&(callback=null);this.sprite.SetShader(CircuitCracker.Shader.Materialize);this.effect=-16;this.SetShaderParams(radius,callback)},Teleport:function(radius){this.sprite.SetShader(CircuitCracker.Shader.Teleport);this.effect=CircuitCracker.LevelObjects.Moveable.maxEffect;this.SetShaderParams(radius)},SetShaderParams:function(radius,callback){callback===void 0&&(callback=null);this.x=this.sprite.rect.X/256;this.y=this.sprite.rect.Y/256;this.radius=radius;this.callback=callback}}});Bridge.define("CircuitCracker.LevelObjects.Detector",{inherits:[CircuitCracker.LevelObjects.LevelObject,CircuitCracker.LevelObjects.ILaserhitable],fields:{receivedThisTick:!1,active:!1},alias:["LaserHit","CircuitCracker$LevelObjects$ILaserhitable$LaserHit"],ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.DetectorInactive.$clone());var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateCircle(CircuitCracker.Game.world,.2,1,p.$clone(),VelcroPhysics.Dynamics.BodyType.Static,this)}},methods:{Reset:function(){this.placedOn.source=!1;this.active=!1;this.sprite.rect=CircuitCracker.Sprites.DetectorInactive.$clone()},Destroy:function(){this.placedOn.source=!1;CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){this.receivedThisTick&&!this.active?(this.placedOn.source=!0,this.active=!0,this.sprite.rect=CircuitCracker.Sprites.DetectorActive.$clone()):this.active&&!this.receivedThisTick&&(this.placedOn.source=!1,this.active=!1,this.sprite.rect=CircuitCracker.Sprites.DetectorInactive.$clone());this.receivedThisTick=!1},LaserHit:function(){this.receivedThisTick=!0}}});Bridge.define("CircuitCracker.LevelObjects.Door",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{doorSprites:null},ctors:{init:function(){this.doorSprites=System.Array.init([CircuitCracker.Sprites.Door0.$clone(),CircuitCracker.Sprites.Door1.$clone(),CircuitCracker.Sprites.Door2.$clone(),CircuitCracker.Sprites.Door3.$clone()],Microsoft.Xna.Framework.Rectangle)}}},fields:{sensor:null,doorState:0,nOfObjects:0,maxState:0},ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.LevelObjects.Door.doorSprites[0]);this.maxState=CircuitCracker.LevelObjects.Door.doorSprites.length-1|0;var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,1,1,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static,this);this.sensor=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,.6,.6,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static);this.sensor.IsSensor=!0;this.sensor.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.sensor.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparation))}},methods:{Reset:function(){this.collider.Enabled=!0;this.doorState=0;this.sprite.rect=CircuitCracker.LevelObjects.Door.doorSprites[0].$clone()},Destroy:function(){CircuitCracker.Game.world.RemoveBody(this.sensor);CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){for(var $t,i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.doorState<this.maxState&&(this.doorState===0&&CircuitCracker.GameContent.SoundEffects.doorOpen.Play(),this.collider.Enabled=!1,this.doorState=this.doorState+1|0,this.sprite.rect=CircuitCracker.LevelObjects.Door.doorSprites[this.doorState].$clone());return}this.doorState>0&&this.nOfObjects<=0&&(this.doorState===this.maxState&&CircuitCracker.GameContent.SoundEffects.doorClose.Play(),this.collider.Enabled=!0,this.doorState=this.doorState-1|0,this.sprite.rect=CircuitCracker.LevelObjects.Door.doorSprites[this.doorState].$clone())},OnCollision:function(fixtureA,fixtureB,contact){this.nOfObjects=this.nOfObjects+1|0},OnSeparation:function(fixtureA,fixtureB,contact){this.nOfObjects=this.nOfObjects-1|0}}});Bridge.define("CircuitCracker.LevelObjects.Goal",{inherits:[CircuitCracker.LevelObjects.LevelObject],fields:{active:!1},ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.Goal.$clone());CircuitCracker.LevelObjects.LevelObject.maxScore=CircuitCracker.LevelObjects.LevelObject.maxScore+1|0;var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateCircle(CircuitCracker.Game.world,.01,1,p.$clone(),VelcroPhysics.Dynamics.BodyType.Static);this.collider.IsSensor=!0;this.collider.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.collider.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparation))}},methods:{Destroy:function(){this.active&&(CircuitCracker.LevelObjects.LevelObject.score=CircuitCracker.LevelObjects.LevelObject.score-1|0,this.active=!1);CircuitCracker.LevelObjects.LevelObject.maxScore=CircuitCracker.LevelObjects.LevelObject.maxScore-1|0;CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},Reset:function(){CircuitCracker.LevelObjects.LevelObject.completed=!1;CircuitCracker.LevelObjects.LevelObject.prototype.Reset.call(this)},OnCollision:function(fixtureA,fixtureB,contact){!this.active&&Bridge.is(fixtureB.Body.UserData,CircuitCracker.LevelObjects.Player)&&(CircuitCracker.LevelObjects.LevelObject.score=CircuitCracker.LevelObjects.LevelObject.score+1|0,this.active=!0,this.CheckWin(!1))},OnSeparation:function(fixtureA,fixtureB,contact){this.active&&Bridge.is(fixtureB.Body.UserData,CircuitCracker.LevelObjects.Player)&&(CircuitCracker.LevelObjects.LevelObject.score=CircuitCracker.LevelObjects.LevelObject.score-1|0,this.active=!1)}}});Bridge.define("CircuitCracker.LevelObjects.Laser",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{laserSprites:null,powerIncreaseTicks:0,nSoundsActive:0},ctors:{init:function(){this.laserSprites=System.Array.init([CircuitCracker.Sprites.Laser0.$clone(),CircuitCracker.Sprites.Laser1.$clone(),CircuitCracker.Sprites.Laser2.$clone(),CircuitCracker.Sprites.Laser3.$clone()],Microsoft.Xna.Framework.Rectangle);this.powerIncreaseTicks=12;this.nSoundsActive=0}}},fields:{ticks:0,powerLevel:0,maxPowerLevel:0,active:!1,point1:null,point2:null,beamSprite:null,hitFixture:null,hitPoint:null,soundActive:!1},ctors:{init:function(){this.point1=new Microsoft.Xna.Framework.Vector2;this.point2=new Microsoft.Xna.Framework.Vector2;this.hitPoint=new Microsoft.Xna.Framework.Vector2;this.soundActive=!1},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.LevelObjects.Laser.laserSprites[0]);var r=placedOn.objFacing*CircuitCracker.LevelObjects.LevelObject.facing2rad,direction=this.FacingDirection(),p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.point1=Microsoft.Xna.Framework.Vector2.op_Addition(p.$clone(),Microsoft.Xna.Framework.Vector2.op_Multiply$1(direction.$clone(),.4));this.point2=Microsoft.Xna.Framework.Vector2.op_Addition(p.$clone(),Microsoft.Xna.Framework.Vector2.op_Multiply$1(direction.$clone(),40));this.collider=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,.4,.8,1,p.$clone(),r,VelcroPhysics.Dynamics.BodyType.Static,this);this.maxPowerLevel=CircuitCracker.LevelObjects.Laser.laserSprites.length-1|0;this.beamSprite=new CircuitCracker.Sprite.ctor(CircuitCracker.Sprites.Box.$clone(),placedOn.pos.$clone(),0,.75);this.beamSprite.color=Microsoft.Xna.Framework.Color.Red.$clone();this.beamSprite.SetEnabled(!1)}},methods:{Reset:function(){this.SoundOff();this.active=!1;this.ticks=0;this.powerLevel=0;this.sprite.rect=CircuitCracker.LevelObjects.Laser.laserSprites[0].$clone();this.beamSprite.SetEnabled(!1)},Destroy:function(){this.SoundOff();this.beamSprite.Remove();CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){for(var $t,i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.powerLevel<this.maxPowerLevel?(this.ticks=this.ticks+1|0,this.ticks>=CircuitCracker.LevelObjects.Laser.powerIncreaseTicks&&(this.ticks=0,this.powerLevel=this.powerLevel+1|0,this.sprite.rect=CircuitCracker.LevelObjects.Laser.laserSprites[this.powerLevel].$clone(),this.powerLevel>=this.maxPowerLevel&&(this.SoundOn(),this.RaycastLaser()))):this.RaycastLaser();return}this.active&&(this.SoundOff(),this.active=!1,this.beamSprite.SetEnabled(!1));this.powerLevel>0&&(this.ticks=this.ticks-1|0,this.ticks<=0&&(this.ticks=CircuitCracker.LevelObjects.Laser.powerIncreaseTicks,this.powerLevel=this.powerLevel-1|0,this.sprite.rect=CircuitCracker.LevelObjects.Laser.laserSprites[this.powerLevel].$clone()))},RaycastLaser:function(){var p,laserhitable;this.active=!0;this.hitFixture=null;CircuitCracker.Game.world.RayCast$1(Bridge.fn.cacheBind(this,this.RayCastCallback),this.point1.$clone(),this.point2.$clone());this.hitFixture!=null&&(p=Microsoft.Xna.Framework.Vector2.op_Division$1(Microsoft.Xna.Framework.Vector2.op_Addition(this.point1.$clone(),this.hitPoint.$clone()),2),this.beamSprite.SetEnabled(!0),this.beamSprite.position=p.$clone(),this.beamSprite.scale=new Microsoft.Xna.Framework.Vector2.$ctor2((Math.abs(this.point1.X-this.hitPoint.X)+.04)/32,(Math.abs(this.point1.Y-this.hitPoint.Y)+.04)/32),(laserhitable=Bridge.as(this.hitFixture.Body.UserData,CircuitCracker.LevelObjects.ILaserhitable))!=null&&laserhitable.CircuitCracker$LevelObjects$ILaserhitable$LaserHit())},RayCastCallback:function(fixture,point,normal,fraction){return fixture.IsSensor?-1:(this.hitFixture=fixture,this.hitPoint=point.$clone(),fraction)},SoundOn:function(){this.soundActive||(CircuitCracker.LevelObjects.Laser.nSoundsActive=CircuitCracker.LevelObjects.Laser.nSoundsActive+1|0,CircuitCracker.GameContent.SoundEffects.laserOn.Play(),this.soundActive=!0)},SoundOff:function(){this.soundActive&&(CircuitCracker.LevelObjects.Laser.nSoundsActive=CircuitCracker.LevelObjects.Laser.nSoundsActive-1|0,CircuitCracker.LevelObjects.Laser.nSoundsActive===0,this.soundActive=!1)}}});Bridge.define("CircuitCracker.LevelObjects.LevelLink",{inherits:[CircuitCracker.LevelObjects.LevelObject],fields:{button:null,locked:!1,hasCompleted:!1},ctors:{init:function(){this.locked=!0;this.hasCompleted=!1},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.None.$clone());this.button=new CircuitCracker.LevelButton(placedOn.pos.$clone(),CircuitCracker.Sprites.LevelLinkLocked.$clone(),null,function(){CircuitCracker.LevelManager.instance.LinkLoadLevel(placedOn.objData)},function(){CircuitCracker.LevelManager.instance.RenderThumbnail(placedOn.pos.$clone(),placedOn.objData)},CircuitCracker.UI.CommonUI.HideTooltip);this.button.SetDisabled(!0);placedOn.objData!=null&&CircuitCracker.Stats.HasClearedLevel(placedOn.objData)&&this.Complete()}},methods:{Destroy:function(){this.button.Destroy();CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},Complete:function(){this.button.SetSpriteRect(CircuitCracker.Sprites.LevelLinkComplete.$clone());this.button.SetDisabled(!1);this.placedOn.source=!0;this.locked=!1;this.hasCompleted=!0},Lock:function(){this.button.SetSpriteRect(CircuitCracker.Sprites.LevelLinkLocked.$clone());this.button.SetDisabled(!0);this.placedOn.source=!1;this.locked=!0;this.hasCompleted=!1},Unlock:function(){this.button.SetSpriteRect(CircuitCracker.Sprites.LevelLinkUnlocked.$clone());this.button.SetDisabled(!1);this.locked=!1},FixedUpdate:function(){var $t,i;if(!this.hasCompleted&&this.locked)for(i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.Unlock();return}}}});Bridge.define("CircuitCracker.LevelObjects.MessageBox",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{messages:null,messagesTouch:null},ctors:{init:function(){this.messages=System.Array.init(["Click on a tile with a green arrow to play!","Use W,A,S,D or the arrow keys to move!\nPress space or shift to sneak.","Press R or the reset button to restart a level.","Join our discord to send us feedback, make requests and discuss solutions!\nYou can find the link on the startpage.\n\nAlso make sure to save your progress via the save-button on the top right\nbevor closing the browser window","A door just opened!\nCheck out what new things are now possible!","Good job on getting this far :)\nClick on the trophy to complete the section!","7","Congratulations, you completed the demo!\nThank you for playing!\n\nPlease consider sending us your save-file over on our discord server.\nYou can download this file via the save-button on the top right."],System.String);this.messagesTouch=System.Array.init([CircuitCracker.LevelObjects.MessageBox.messages[0],"Swipe and hold in a direction to move that way.","Press the reset button on the top left to restart a level.",CircuitCracker.LevelObjects.MessageBox.messages[3],CircuitCracker.LevelObjects.MessageBox.messages[4],CircuitCracker.LevelObjects.MessageBox.messages[5],CircuitCracker.LevelObjects.MessageBox.messages[6],CircuitCracker.LevelObjects.MessageBox.messages[7]],System.String)}}},fields:{button:null,locked:!1},ctors:{init:function(){this.locked=!0},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.None.$clone());this.button=new CircuitCracker.LevelButton(placedOn.pos.$clone(),CircuitCracker.Sprites.MessageBox.$clone(),null,Bridge.fn.cacheBind(this,this.ShowMessage));this.button.SetDisabled(!0)}},methods:{ShowMessage:function(){var idx=this.placedOn.GetObjectColor(),msg=CircuitCracker.Game.TouchInput?CircuitCracker.LevelObjects.MessageBox.messagesTouch[idx]:CircuitCracker.LevelObjects.MessageBox.messages[idx];CircuitCracker.UI.CommonUI.ShowDialogBox(msg,null)},Destroy:function(){this.button.Destroy();CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){var $t,i;if(this.locked)for(i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.button.SetDisabled(!1);this.locked=!1;this.ShowMessage();return}}}});Bridge.define("CircuitCracker.LevelObjects.Piston",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{motorSpeed:0,maxMotorForce:0},ctors:{init:function(){this.motorSpeed=4;this.maxMotorForce=200}}},fields:{headSprite:null,pistonHead:null,pistonJoint:null,active:!1},ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.PistonBody.$clone());var axis=this.FacingDirection(),p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,1,1,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static,this);this.pistonHead=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,.96,.96,2,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Dynamic,this);this.pistonJoint=VelcroPhysics.Factories.JointFactory.CreatePrismaticJoint(CircuitCracker.Game.world,this.collider,this.pistonHead,p.$clone(),axis.$clone());this.pistonJoint.LocalAnchorA=Microsoft.Xna.Framework.Vector2.Zero.$clone();this.pistonJoint.LocalAnchorB=Microsoft.Xna.Framework.Vector2.Zero.$clone();this.pistonJoint.CollideConnected=!1;this.pistonJoint.LimitEnabled=!0;this.pistonJoint.SetLimits(0,1);this.pistonJoint.MotorEnabled=!0;this.pistonJoint.MaxMotorForce=CircuitCracker.LevelObjects.Piston.maxMotorForce;this.pistonJoint.MotorSpeed=-4;this.sprite.SetSortOrder(.74);this.headSprite=new CircuitCracker.Sprite.ctor(CircuitCracker.Sprites.PistonHead.$clone(),placedOn.pos.$clone(),placedOn.objFacing,.75)}},methods:{Reset:function(){this.active=!1;this.pistonJoint.MotorSpeed=-4;var p=new Microsoft.Xna.Framework.Vector2.$ctor2(this.placedOn.pos.$clone().X,this.placedOn.pos.$clone().Y);this.pistonHead.Position=p.$clone();this.headSprite.position=p.$clone()},Destroy:function(){this.headSprite.Remove();CircuitCracker.Game.world.RemoveJoint(this.pistonJoint);CircuitCracker.Game.world.RemoveBody(this.pistonHead);CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){var $t,i;for(this.headSprite.position=this.pistonHead.Position.$clone(),i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.active||(this.pistonJoint.MotorSpeed=CircuitCracker.LevelObjects.Piston.motorSpeed,this.active=!0,CircuitCracker.GameContent.SoundEffects.piston.Play());return}this.active&&(this.pistonJoint.MotorSpeed=-4,this.active=!1,CircuitCracker.GameContent.SoundEffects.piston.Play())}}});Bridge.define("CircuitCracker.LevelObjects.Plate",{inherits:[CircuitCracker.LevelObjects.LevelObject],fields:{nOfObjects:0},ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.PlateInactive.$clone());var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateCircle(CircuitCracker.Game.world,.2,1,p.$clone(),VelcroPhysics.Dynamics.BodyType.Static);this.collider.IsSensor=!0;this.collider.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.collider.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparation))}},methods:{Reset:function(){this.placedOn.source=!1;this.sprite.rect=CircuitCracker.Sprites.PlateInactive.$clone()},OnCollision:function(fixtureA,fixtureB,contact){Bridge.is(fixtureB.Body.UserData,CircuitCracker.LevelObjects.Moveable)&&(this.nOfObjects===0&&(this.sprite.rect=CircuitCracker.Sprites.PlateActive.$clone(),this.placedOn.source=!0,CircuitCracker.GameContent.SoundEffects.plate.Play()),this.nOfObjects=this.nOfObjects+1|0)},OnSeparation:function(fixtureA,fixtureB,contact){Bridge.is(fixtureB.Body.UserData,CircuitCracker.LevelObjects.Moveable)&&(this.nOfObjects=this.nOfObjects-1|0,this.nOfObjects===0&&(this.sprite.rect=CircuitCracker.Sprites.PlateInactive.$clone(),this.placedOn.source=!1,CircuitCracker.GameContent.SoundEffects.plate.Play()))}}});Bridge.define("CircuitCracker.LevelObjects.Resetor",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{good:null,okay:null,error:null},ctors:{init:function(){this.good=new Microsoft.Xna.Framework.Color;this.okay=new Microsoft.Xna.Framework.Color;this.error=new Microsoft.Xna.Framework.Color;this.good=new Microsoft.Xna.Framework.Color.$ctor6(0,174,64);this.okay=new Microsoft.Xna.Framework.Color.$ctor6(255,204,6);this.error=new Microsoft.Xna.Framework.Color.$ctor6(230,38,38)}}},fields:{bodyList:null,objectDetector:null,arrowSprite:null,lookingAt:null,blockBlinks:0,active:!1},ctors:{init:function(){this.lookingAt=new Microsoft.Xna.Framework.Point;this.bodyList=new(System.Collections.Generic.List$1(VelcroPhysics.Dynamics.Body).ctor)},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.Reseter.$clone());var direction=this.FacingDirection(),p=placedOn.pos.$clone().ToVector2();this.lookingAt=Microsoft.Xna.Framework.Vector2.op_Addition(p.$clone(),direction.$clone()).ToPoint();this.collider=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,1,1,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static,this);this.objectDetector=VelcroPhysics.Factories.BodyFactory.CreateCircle(CircuitCracker.Game.world,.2,1,Microsoft.Xna.Framework.Vector2.op_Addition(p.$clone(),direction.$clone()),VelcroPhysics.Dynamics.BodyType.Static);this.objectDetector.IsSensor=!0;this.objectDetector.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.objectDetector.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparation));this.arrowSprite=new CircuitCracker.Sprite.ctor(CircuitCracker.Sprites.ReseterArrow.$clone(),placedOn.pos.$clone(),placedOn.objFacing,.6,CircuitCracker.LevelObjects.Resetor.good.$clone())}},methods:{Destroy:function(){CircuitCracker.Game.world.RemoveBody(this.objectDetector);this.arrowSprite.Remove();CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){var $t,pos={v:new Microsoft.Xna.Framework.Point},valid={},c,i;for(this.ResetPossible(pos,valid),this.arrowSprite.color=valid.v?Microsoft.Xna.Framework.Point.op_Equality(pos.v.$clone(),this.lookingAt.$clone())?CircuitCracker.LevelObjects.Resetor.good.$clone():CircuitCracker.LevelObjects.Resetor.okay.$clone():CircuitCracker.LevelObjects.Resetor.error.$clone(),this.blockBlinks>0&&(c=CircuitCracker.LevelObjects.Resetor.error.$clone(),this.arrowSprite.color=this.blockBlinks%20>=10?Microsoft.Xna.Framework.Color.op_Multiply(c.$clone(),.8):Microsoft.Xna.Framework.Color.op_Multiply(c.$clone(),.2),this.blockBlinks=this.blockBlinks-1|0),i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.active||(this.active=!0,valid.v&&this.TryResetObject(pos.v.$clone()));return}this.active=!1},ResetPossible:function(position,valid){var $t,first=!0,body,m;position.v=this.lookingAt.$clone();valid.v=!0;$t=Bridge.getEnumerator(this.bodyList);try{while($t.moveNext())if(body=$t.Current,(m=Bridge.as(body.UserData,CircuitCracker.LevelObjects.Moveable))!=null)if(first)first=!1,position.v=m.placedOn.pos.$clone();else if(Microsoft.Xna.Framework.Point.op_Inequality(m.placedOn.pos.$clone(),position.v.$clone())){valid.v=!1;break}}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},TryResetObject:function(origin){for(var y,f,obj,first,body,mov,$t,testPos=origin.ToVector2(),x=-1;x<2;x=x+1|0)for(y=-1;y<2;y=y+1|0)if(f=CircuitCracker.Game.world.TestPoint(Microsoft.Xna.Framework.Vector2.op_Addition(testPos.$clone(),new Microsoft.Xna.Framework.Vector2.$ctor2(x*.4,y*.4))),f!=null&&!f.IsSensor&&!((obj=Bridge.as(f.Body.UserData,CircuitCracker.LevelObjects.LevelObject))!=null&&Microsoft.Xna.Framework.Point.op_Equality(obj.placedOn.pos.$clone(),origin.$clone()))){this.blockBlinks=40;return}CircuitCracker.GameContent.SoundEffects.reset.Play();first=!0;$t=Bridge.getEnumerator(CircuitCracker.Game.world.BodyList);try{while($t.moveNext())body=$t.Current,(mov=Bridge.as(body.UserData,CircuitCracker.LevelObjects.Moveable))!=null&&Microsoft.Xna.Framework.Point.op_Equality(mov.placedOn.pos.$clone(),origin.$clone())&&(first?(mov.Reset(),mov.Enable(),first=!1):mov.enabled=!1)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},OnCollision:function(fixtureA,fixtureB,contact){this.bodyList.add(fixtureB.Body)},OnSeparation:function(fixtureA,fixtureB,contact){this.bodyList.remove(fixtureB.Body)}}});Bridge.define("CircuitCracker.LevelObjects.RobotSensor",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{robotSensors:null},ctors:{init:function(){this.robotSensors=System.Array.init([new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor),new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor),new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor),new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor),new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor),new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor),new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor),new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor).ctor)],System.Collections.Generic.List$1(CircuitCracker.LevelObjects.RobotSensor))}}},fields:{decal:null,hitFixture:null,lookingAt:null,active:!1,received:!1},ctors:{init:function(){this.lookingAt=new Microsoft.Xna.Framework.Vector2},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.RobotSensor.$clone());var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.lookingAt=Microsoft.Xna.Framework.Vector2.op_Addition(p.$clone(),this.FacingDirection());this.collider=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,1,1,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static,this);this.decal=new CircuitCracker.Sprite.ctor(CircuitCracker.Sprites.RobotSensorDecal.$clone(),placedOn.pos.$clone(),placedOn.objFacing,1);this.decal.color=CircuitCracker.LevelRenderer.colors[placedOn.GetObjectColor()].$clone();CircuitCracker.LevelObjects.RobotSensor.robotSensors[placedOn.GetObjectColor()].add(this)}},methods:{Reset:function(){this.placedOn.source=!1;this.active=!1;this.hitFixture=null},Destroy:function(){this.placedOn.source=!1;this.decal.Remove();CircuitCracker.LevelObjects.RobotSensor.robotSensors[this.placedOn.GetObjectColor()].remove(this);CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},FixedUpdate:function(){this.hitFixture=null;CircuitCracker.Game.world.RayCast$1(Bridge.fn.cacheBind(this,this.RayCastCallback),this.collider.Position.$clone(),this.lookingAt.$clone());this.received!==this.active&&(this.active=this.received,this.placedOn.source=this.received,CircuitCracker.GameContent.SoundEffects.sensor.Play());this.received=!1},SetActive:function(){this.received=!0},GetSensorFixture:function(){return this.hitFixture},RayCastCallback:function(fixture,point,normal,fraction){return fixture.IsSensor?-1:(this.hitFixture=fixture,fraction)}}});Bridge.define("CircuitCracker.LevelObjects.Spike",{inherits:[CircuitCracker.LevelObjects.LevelObject],fields:{touchingBodies:null,active:!1},ctors:{init:function(){this.touchingBodies=new(System.Collections.Generic.List$1(VelcroPhysics.Dynamics.Body).ctor)},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.SpikeInactive.$clone());var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateCircle(CircuitCracker.Game.world,.2,1,p.$clone(),VelcroPhysics.Dynamics.BodyType.Static);this.collider.IsSensor=!0;this.collider.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.collider.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparation))}},methods:{Reset:function(){this.active=!1;this.sprite.rect=CircuitCracker.Sprites.SpikeInactive.$clone();this.touchingBodies.clear()},FixedUpdate:function(){var $t,i,j,b,damageable;if(!this.active)for(i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){for(this.active=!0,this.sprite.rect=CircuitCracker.Sprites.SpikeActive.$clone(),CircuitCracker.GameContent.SoundEffects.spike.Play(),j=0;j<this.touchingBodies.Count;j=j+1|0)b=this.touchingBodies.getItem(j),(damageable=Bridge.as(b.UserData,CircuitCracker.LevelObjects.IDamageable))!=null&&damageable.CircuitCracker$LevelObjects$IDamageable$Damage();this.touchingBodies.clear();return}},OnCollision:function(fixtureA,fixtureB,contact){if(this.active){var damageable;(damageable=Bridge.as(fixtureB.Body.UserData,CircuitCracker.LevelObjects.IDamageable))!=null&&(damageable.CircuitCracker$LevelObjects$IDamageable$Damage(),this.active=!1,CircuitCracker.GameContent.SoundEffects.spike.Play(),this.sprite.rect=CircuitCracker.Sprites.SpikeInactive.$clone())}else this.touchingBodies.add(fixtureB.Body)},OnSeparation:function(fixtureA,fixtureB,contact){this.active||this.touchingBodies.remove(fixtureB.Body)}}});Bridge.define("CircuitCracker.LevelObjects.Teleporter",{inherits:[CircuitCracker.LevelObjects.LevelObject],statics:{fields:{maxTeleporterCount:0,teleporters:null,teleporting:null},ctors:{init:function(){this.maxTeleporterCount=16;this.teleporters=new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.Teleporter).ctor);this.teleporting=new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.ITeleportable).ctor)}}},fields:{teleported:null,touchingBodies:null,nOftouchingPrev:0,nOfObjectsDetector:0,objectDetector:null,powered:!1,poweredPrev:!1,blocked:!1,updated:!1},ctors:{init:function(){this.teleported=new(System.Collections.Generic.List$1(CircuitCracker.LevelObjects.Moveable).ctor);this.touchingBodies=new(System.Collections.Generic.List$1(VelcroPhysics.Dynamics.Body).ctor)},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.TeleporterInactive.$clone());CircuitCracker.LevelObjects.Teleporter.teleporters.Count===CircuitCracker.LevelObjects.Teleporter.maxTeleporterCount&&CircuitCracker.LevelObjects.Teleporter.teleporters.getItem(0).placedOn.DestroyObject();CircuitCracker.LevelObjects.Teleporter.teleporters.add(this);var p=new Microsoft.Xna.Framework.Vector2.$ctor2(placedOn.pos.$clone().X,placedOn.pos.$clone().Y);this.collider=VelcroPhysics.Factories.BodyFactory.CreateCircle(CircuitCracker.Game.world,.2,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static);this.collider.IsSensor=!0;this.collider.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.collider.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparation));this.objectDetector=VelcroPhysics.Factories.BodyFactory.CreateRectangle(CircuitCracker.Game.world,.8,.8,1,p.$clone(),0,VelcroPhysics.Dynamics.BodyType.Static);this.objectDetector.IsSensor=!0;this.objectDetector.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollisionDetector));this.objectDetector.addOnSeparation(Bridge.fn.cacheBind(this,this.OnSeparationDetector))}},methods:{Destroy:function(){var $t,obj;$t=Bridge.getEnumerator(this.teleported);try{while($t.moveNext())obj={v:Bridge.cast($t.Current,CircuitCracker.LevelObjects.LevelObject)},obj.v!=null?obj.v.Destroy():null}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}CircuitCracker.LevelObjects.Teleporter.teleporters.remove(this);CircuitCracker.Game.world.RemoveBody(this.objectDetector);CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},Reset:function(){var $t,obj;$t=Bridge.getEnumerator(this.teleported);try{while($t.moveNext())obj={v:Bridge.cast($t.Current,CircuitCracker.LevelObjects.LevelObject)},obj.v!=null?obj.v.Destroy():null}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}this.teleported.clear();this.powered=!1;this.sprite.rect=CircuitCracker.Sprites.TeleporterInactive.$clone()},FixedUpdate:function(){for(var obj,i1,obj1,update2,teleporter,teleIdx,teleporter1,toTele,obj2,teleporter2,$t,$t1,$t2,$t3,i=this.teleported.Count-1|0;i>=0;i=i-1|0)obj=this.teleported.getItem(i),obj.enabled||(this.teleported.removeAt(i),obj.Destroy());for(this.poweredPrev=this.powered,this.powered=!1,i1=0;i1<4;i1=i1+1|0)if(($t=this.placedOn.signalStrength)[i1]!==0){this.powered=!0;this.sprite.rect=CircuitCracker.Sprites.TeleporterActive.$clone();break}this.powered&&this.nOfObjectsDetector!==0||(this.blocked=!1);(!this.powered||this.blocked)&&(this.sprite.rect=CircuitCracker.Sprites.TeleporterInactive.$clone());this.touchingBodies.Count!==1||!this.powered||this.poweredPrev&&this.nOftouchingPrev!==0||this.blocked||(this.blocked=!0,(obj1=Bridge.as(this.touchingBodies.getItem(0).UserData,CircuitCracker.LevelObjects.ITeleportable))!=null&&(CircuitCracker.LevelObjects.Teleporter.teleporting.add(obj1),CircuitCracker.GameContent.SoundEffects.teleporter.Play(),obj1.CircuitCracker$LevelObjects$ITeleportable$TeleportRemove()));this.updated=!0;update2=!0;$t1=Bridge.getEnumerator(CircuitCracker.LevelObjects.Teleporter.teleporters);try{while($t1.moveNext())if(teleporter=$t1.Current,!teleporter.updated){update2=!1;break}}finally{Bridge.is($t1,System.IDisposable)&&$t1.System$IDisposable$Dispose()}if(update2){if(CircuitCracker.LevelObjects.Teleporter.teleporting.Count>0){teleIdx=0;$t2=Bridge.getEnumerator(CircuitCracker.LevelObjects.Teleporter.teleporters);try{while($t2.moveNext())if(teleporter1=$t2.Current,teleporter1.powered&&!teleporter1.blocked){toTele=Bridge.as(CircuitCracker.LevelObjects.Teleporter.teleporting.getItem(teleIdx),CircuitCracker.LevelObjects.Moveable);obj2=null;switch(toTele.id){case 3:obj2=new CircuitCracker.LevelObjects.Player(toTele.placedOn,toTele.id);break;case 10:obj2=new CircuitCracker.LevelObjects.InversePlayer(toTele.placedOn,toTele.id);break;case 2:obj2=new CircuitCracker.LevelObjects.Crate(toTele.placedOn,toTele.id);break;case 9:obj2=new CircuitCracker.LevelObjects.MetalCrate(toTele.placedOn,toTele.id);break;case 13:obj2=new CircuitCracker.LevelObjects.Robot(toTele.placedOn,toTele.id);break}obj2.SetTransform(teleporter1.placedOn.pos.$clone(),toTele.placedOn.objFacing);this.teleported.add(obj2);Bridge.cast(obj2,CircuitCracker.LevelObjects.ITeleportable).CircuitCracker$LevelObjects$ITeleportable$TeleportAdd();teleporter1.blocked=!0;teleIdx=CircuitCracker.Utilities.LoopValue(teleIdx+1|0,CircuitCracker.LevelObjects.Teleporter.teleporting.Count)}}finally{Bridge.is($t2,System.IDisposable)&&$t2.System$IDisposable$Dispose()}CircuitCracker.LevelObjects.Teleporter.teleporting.clear()}$t3=Bridge.getEnumerator(CircuitCracker.LevelObjects.Teleporter.teleporters);try{while($t3.moveNext())teleporter2=$t3.Current,teleporter2.nOftouchingPrev=teleporter2.touchingBodies.Count,teleporter2.updated=!1}finally{Bridge.is($t3,System.IDisposable)&&$t3.System$IDisposable$Dispose()}}},OnCollision:function(fixtureA,fixtureB,contact){this.touchingBodies.add(fixtureB.Body)},OnSeparation:function(fixtureA,fixtureB,contact){this.touchingBodies.remove(fixtureB.Body)},OnCollisionDetector:function(fixtureA,fixtureB,contact){this.nOfObjectsDetector=this.nOfObjectsDetector+1|0},OnSeparationDetector:function(fixtureA,fixtureB,contact){this.nOfObjectsDetector=this.nOfObjectsDetector-1|0}}});Bridge.define("CircuitCracker.LevelObjects.WinBlock",{inherits:[CircuitCracker.LevelObjects.LevelObject],fields:{button:null,active:!1},ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.LevelObject.ctor.call(this,placedOn,id,CircuitCracker.Sprites.None.$clone());this.button=new CircuitCracker.LevelButton(placedOn.pos.$clone(),CircuitCracker.Sprites.WinblockInactive.$clone(),null,Bridge.fn.bind(this,function(){this.CheckWin(!0)}));this.button.SetDisabled(!0);CircuitCracker.LevelObjects.LevelObject.nWinBlocks=CircuitCracker.LevelObjects.LevelObject.nWinBlocks+1|0;CircuitCracker.LevelObjects.LevelObject.maxScore=CircuitCracker.LevelObjects.LevelObject.maxScore+1|0}},methods:{Destroy:function(){this.active&&(CircuitCracker.LevelObjects.LevelObject.score=CircuitCracker.LevelObjects.LevelObject.score-1|0,this.active=!1);CircuitCracker.LevelObjects.LevelObject.maxScore=CircuitCracker.LevelObjects.LevelObject.maxScore-1|0;CircuitCracker.LevelObjects.LevelObject.nWinBlocks=CircuitCracker.LevelObjects.LevelObject.nWinBlocks-1|0;this.placedOn.source=!1;this.button.Destroy();CircuitCracker.LevelObjects.LevelObject.prototype.Destroy.call(this)},Reset:function(){CircuitCracker.LevelObjects.LevelObject.completed=!1;this.placedOn.source=!1;this.button.SetDisabled(!0);this.button.SetSpriteRect(CircuitCracker.Sprites.WinblockInactive.$clone())},FixedUpdate:function(){var $t,i;if(!this.placedOn.source){for(i=0;i<4;i=i+1|0)if(($t=this.placedOn.signalStrength)[i]!==0){this.active||(CircuitCracker.LevelObjects.LevelObject.score=CircuitCracker.LevelObjects.LevelObject.score+1|0,this.active=!0,this.CheckWin(!1));CircuitCracker.LevelObjects.LevelObject.completed&&(this.placedOn.source=!0,this.button.SetDisabled(!1),this.button.SetSpriteRect(CircuitCracker.Sprites.WinblockActive.$clone()));return}this.active&&(CircuitCracker.LevelObjects.LevelObject.score=CircuitCracker.LevelObjects.LevelObject.score-1|0,this.active=!1)}}}});Bridge.define("CircuitCracker.UI.Panel",{inherits:[CircuitCracker.UI.UIElement],fields:{bgSprite:null,borderSize:null,borderColor:null,bgColor:null,width:0,height:0,drawBorder:!1},ctors:{init:function(){this.bgSprite=new Microsoft.Xna.Framework.Rectangle;this.borderSize=new CircuitCracker.UI.Thickness;this.borderColor=new Microsoft.Xna.Framework.Color;this.bgColor=new Microsoft.Xna.Framework.Color;this.bgSprite=CircuitCracker.Sprites.HalfBox.$clone()},ctor:function(){CircuitCracker.UI.Panel.$ctor2.call(this,0,0,null)},$ctor1:function(bgColor){CircuitCracker.UI.Panel.$ctor2.call(this,0,0,bgColor)},$ctor2:function(width,height,bgColor){bgColor===void 0&&(bgColor=null);this.$initialize();CircuitCracker.UI.UIElement.ctor.call(this);this.width=width;this.height=height;this.bgColor=System.Nullable.getValueOrDefault(bgColor,Microsoft.Xna.Framework.Color.op_Multiply(Microsoft.Xna.Framework.Color.Black.$clone(),.75)).$clone()}},methods:{Width:function(){return this.width},Height:function(){return this.height},SetBackgroundColor:function(color){this.bgColor=color.$clone()},ShowBorder:function(size,color){this.drawBorder=!0;this.borderSize=size.$clone();this.borderColor=color.$clone()},HideBorder:function(){this.drawBorder=!1},Render:function(spriteBatch,tex){this.drawBorder&&spriteBatch.Draw$1(tex,CircuitCracker.UI.Thickness.op_Addition(this.rect.$clone(),this.borderSize.$clone()),this.bgSprite.$clone(),this.borderColor.$clone());spriteBatch.Draw$1(tex,this.rect.$clone(),this.bgSprite.$clone(),this.bgColor.$clone())}}});Bridge.define("CircuitCracker.UI.HorizontalLayout",{inherits:[CircuitCracker.UI.UIElement],fields:{spacing:0},ctors:{ctor:function(spacing,children){children===void 0&&(children=[]);this.$initialize();CircuitCracker.UI.UIElement.$ctor1.call(this,children);this.spacing=spacing}},methods:{Height:function(){var $t,max=0,child;$t=Bridge.getEnumerator(this.children);try{while($t.moveNext())child=$t.Current,max=Math.max(max,child.Height())}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return max},Width:function(){var $t,h=-this.spacing|0,child;$t=Bridge.getEnumerator(this.children);try{while($t.moveNext())child=$t.Current,h=h+((child.Width()+Bridge.Int.mul(child.margin,2)|0)+this.spacing|0)|0}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return h},Render:function(spriteBatch,texture){},RenderBase:function(spriteBatch,tex,view){var childPos,i,childWidth,r;if(this.Visible)for(this.CalcRect(view.$clone()),childPos=0,i=0;i<this.children.Count;i=i+1|0)childWidth=this.children.getItem(i).Width(),r=new Microsoft.Xna.Framework.Rectangle.$ctor2(this.rect.X+childPos|0,this.rect.Y,childWidth,this.rect.Height),this.children.getItem(i).RenderBase(spriteBatch,tex,r.$clone()),childPos=childPos+((childWidth+this.spacing|0)+Bridge.Int.mul(this.children.getItem(i).margin,2)|0)|0}}});Bridge.define("CircuitCracker.UI.VerticalLayout",{inherits:[CircuitCracker.UI.UIElement],fields:{spacing:0},ctors:{ctor:function(spacing,children){children===void 0&&(children=[]);this.$initialize();CircuitCracker.UI.UIElement.$ctor1.call(this,children);this.spacing=spacing}},methods:{Height:function(){var $t,h=-this.spacing|0,child;$t=Bridge.getEnumerator(this.children);try{while($t.moveNext())child=$t.Current,h=h+((child.Height()+Bridge.Int.mul(child.margin,2)|0)+this.spacing|0)|0}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return h},Width:function(){var $t,max=0,child;$t=Bridge.getEnumerator(this.children);try{while($t.moveNext())child=$t.Current,max=Math.max(max,child.Width())}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return max},Render:function(spriteBatch,texture){},RenderBase:function(spriteBatch,tex,view){var childPos,i,childHeight,r;if(this.Visible)for(this.CalcRect(view.$clone()),childPos=0,i=0;i<this.children.Count;i=i+1|0)childHeight=this.children.getItem(i).Height(),r=new Microsoft.Xna.Framework.Rectangle.$ctor2(this.rect.X,this.rect.Y+childPos|0,this.rect.Width,childHeight),this.children.getItem(i).RenderBase(spriteBatch,tex,r.$clone()),childPos=childPos+((childHeight+this.spacing|0)+Bridge.Int.mul(this.children.getItem(i).margin,2)|0)|0}}});Bridge.define("CircuitCracker.LevelObjects.Crate",{inherits:[CircuitCracker.LevelObjects.Moveable,CircuitCracker.LevelObjects.IDamageable,CircuitCracker.LevelObjects.ILaserhitable,CircuitCracker.LevelObjects.ITeleportable],alias:["Damage","CircuitCracker$LevelObjects$IDamageable$Damage","LaserHit","CircuitCracker$LevelObjects$ILaserhitable$LaserHit","TeleportAdd","CircuitCracker$LevelObjects$ITeleportable$TeleportAdd","TeleportRemove","CircuitCracker$LevelObjects$ITeleportable$TeleportRemove"],ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.Moveable.ctor.call(this,placedOn,id,CircuitCracker.Sprites.CrateNormal.$clone(),new VelcroPhysics.Shared.Vertices.$ctor1(CircuitCracker.Utilities.ConstructOctogonal(.48,.32)),.6);this.sprite.SetSortOrder(.76);this.Pushable=!0}},methods:{Damage:function(){CircuitCracker.GameContent.SoundEffects.crateDestroy.Play();this.Dissolve(.4)},LaserHit:function(){this.Damage()},TeleportAdd:function(){this.Materialize(.4)},TeleportRemove:function(){this.Teleport(.4)}}});Bridge.define("CircuitCracker.LevelObjects.PlayerBase",{inherits:[CircuitCracker.LevelObjects.Moveable,CircuitCracker.LevelObjects.IDamageable,CircuitCracker.LevelObjects.ILaserhitable,CircuitCracker.LevelObjects.ITeleportable],statics:{fields:{speed:0,walking:null,pushing:null,stepDistance:0},ctors:{init:function(){this.speed=7;this.walking=System.Array.init([CircuitCracker.Sprites.PlayerWalking0.$clone(),CircuitCracker.Sprites.PlayerWalking1.$clone()],Microsoft.Xna.Framework.Rectangle);this.pushing=System.Array.init([CircuitCracker.Sprites.PlayerPushing0.$clone(),CircuitCracker.Sprites.PlayerPushing1.$clone()],Microsoft.Xna.Framework.Rectangle);this.stepDistance=.2}}},fields:{hitFixture:null,lastAnimationPos:null,currentSprite:0,direction:0,lastFlipped:!1,isWalking:!1,canWalk:!1},alias:["Damage","CircuitCracker$LevelObjects$IDamageable$Damage","LaserHit","CircuitCracker$LevelObjects$ILaserhitable$LaserHit","TeleportAdd","CircuitCracker$LevelObjects$ITeleportable$TeleportAdd","TeleportRemove","CircuitCracker$LevelObjects$ITeleportable$TeleportRemove"],ctors:{init:function(){this.lastAnimationPos=new Microsoft.Xna.Framework.Vector2;this.canWalk=!0},ctor:function(placedOn,id,direction){this.$initialize();CircuitCracker.LevelObjects.Moveable.ctor.call(this,placedOn,id,CircuitCracker.LevelObjects.PlayerBase.walking[0],new VelcroPhysics.Shared.Vertices.$ctor1(CircuitCracker.Utilities.ConstructOctogonal(.35,.18)),1.6);this.direction=direction;this.sprite.SetSortOrder(.75)}},methods:{Reset:function(){this.canWalk=!0;CircuitCracker.LevelObjects.Moveable.prototype.Reset.call(this)},FixedUpdate:function(){if(CircuitCracker.LevelObjects.Moveable.prototype.FixedUpdate.call(this),this.canWalk){if(Microsoft.Xna.Framework.Vector2.op_Inequality(CircuitCracker.LevelObjects.Moveable.movedir.$clone(),Microsoft.Xna.Framework.Vector2.Zero.$clone())){this.isWalking=!0;CircuitCracker.LevelObjects.Moveable.movedir.Normalize();this.collider.LinearVelocity=Microsoft.Xna.Framework.Vector2.op_Addition(this.collider.LinearVelocity.$clone(),Microsoft.Xna.Framework.Vector2.op_Multiply$1(Microsoft.Xna.Framework.Vector2.op_Multiply$1(Microsoft.Xna.Framework.Vector2.op_Multiply$1(CircuitCracker.LevelObjects.Moveable.movedir.$clone(),CircuitCracker.LevelObjects.PlayerBase.speed),CircuitCracker.LevelObjects.Moveable.speedModifier),this.direction));this.sprite.rotation=Math.acos(-CircuitCracker.LevelObjects.Moveable.movedir.Y)*(CircuitCracker.LevelObjects.Moveable.movedir.X<0?-1:1);Microsoft.Xna.Framework.Vector2.op_Subtraction(this.collider.Position.$clone(),this.lastAnimationPos.$clone()).LengthSquared()>=CircuitCracker.LevelObjects.PlayerBase.stepDistance&&(this.lastAnimationPos=this.collider.Position.$clone(),this.currentSprite=this.currentSprite+1|0,this.currentSprite===1&&(this.lastFlipped?this.sprite.effects&=-2:this.sprite.effects|=Microsoft.Xna.Framework.Graphics.SpriteEffects.FlipHorizontally,this.lastFlipped=!this.lastFlipped));this.hitFixture=null;CircuitCracker.Game.world.RayCast$1(Bridge.fn.cacheBind(this,this.RayCastCallback),this.collider.Position.$clone(),Microsoft.Xna.Framework.Vector2.op_Addition(this.collider.Position.$clone(),Microsoft.Xna.Framework.Vector2.op_Multiply$1(CircuitCracker.LevelObjects.Moveable.movedir.$clone(),this.direction)));var m;this.hitFixture!=null&&(m=Bridge.as(this.hitFixture.Body.UserData,CircuitCracker.LevelObjects.Moveable))!=null&&m.Pushable?(this.currentSprite>=CircuitCracker.LevelObjects.PlayerBase.pushing.length&&(this.currentSprite=0),this.sprite.rect=CircuitCracker.LevelObjects.PlayerBase.pushing[this.currentSprite].$clone()):(this.currentSprite>=CircuitCracker.LevelObjects.PlayerBase.walking.length&&(this.currentSprite=0),this.sprite.rect=CircuitCracker.LevelObjects.PlayerBase.walking[this.currentSprite].$clone())}else this.isWalking&&(this.isWalking=!1,this.sprite.rect=CircuitCracker.LevelObjects.PlayerBase.walking[0].$clone(),this.currentSprite=0);this.collider.LinearDamping=this.isWalking?37:25}},RayCastCallback:function(fixture,point,normal,fraction){return this.hitFixture=fixture,fraction},Damage:function(){CircuitCracker.Stats.AddDeath();CircuitCracker.GameContent.SoundEffects.playerDeath.Play();this.canWalk=!1;this.Dissolve(.25)},LaserHit:function(){this.Damage()},TeleportAdd:function(){this.canWalk=!1;this.Materialize(.25,Bridge.fn.bind(this,function(){this.canWalk=!0}))},TeleportRemove:function(){this.canWalk=!1;this.Teleport(.25)}}});Bridge.define("CircuitCracker.LevelObjects.MetalCrate",{inherits:[CircuitCracker.LevelObjects.Moveable,CircuitCracker.LevelObjects.IDamageable,CircuitCracker.LevelObjects.ITeleportable],alias:["Damage","CircuitCracker$LevelObjects$IDamageable$Damage","TeleportAdd","CircuitCracker$LevelObjects$ITeleportable$TeleportAdd","TeleportRemove","CircuitCracker$LevelObjects$ITeleportable$TeleportRemove"],ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.Moveable.ctor.call(this,placedOn,id,CircuitCracker.Sprites.CrateMetal.$clone(),new VelcroPhysics.Shared.Vertices.$ctor1(CircuitCracker.Utilities.ConstructOctogonal(.48,.32)),1.2);this.sprite.SetSortOrder(.76);this.Pushable=!0}},methods:{Damage:function(){CircuitCracker.GameContent.SoundEffects.crateDestroy.Play();this.Dissolve(.4)},TeleportAdd:function(){this.Materialize(.4)},TeleportRemove:function(){this.Teleport(.4)}}});Bridge.define("CircuitCracker.LevelObjects.Robot",{inherits:[CircuitCracker.LevelObjects.Moveable,CircuitCracker.LevelObjects.IDamageable,CircuitCracker.LevelObjects.ILaserhitable,CircuitCracker.LevelObjects.ITeleportable],statics:{fields:{speed:0},ctors:{init:function(){this.speed=CircuitCracker.LevelObjects.PlayerBase.speed}}},fields:{baseSprite:null,decal:null,hitFixture:null,lookDir:null,canWalk:!1,iForward:0,iTurnRight:0,lastTurnRight:!1,iTurnAround:0,lastTurnAround:!1,iTurnLeft:0,lastTurnLeft:!1},alias:["Damage","CircuitCracker$LevelObjects$IDamageable$Damage","LaserHit","CircuitCracker$LevelObjects$ILaserhitable$LaserHit","TeleportAdd","CircuitCracker$LevelObjects$ITeleportable$TeleportAdd","TeleportRemove","CircuitCracker$LevelObjects$ITeleportable$TeleportRemove"],ctors:{init:function(){this.lookDir=new Microsoft.Xna.Framework.Vector2;this.canWalk=!0},ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.Moveable.ctor.call(this,placedOn,id,CircuitCracker.Sprites.Robot.$clone(),new VelcroPhysics.Shared.Vertices.$ctor1(CircuitCracker.Utilities.ConstructOctogonal(.3,.25)),2);this.lookDir=this.FacingDirection();this.iForward=placedOn.objFacing;this.iTurnRight=(this.iForward+1|0)%4;this.iTurnAround=(this.iForward+2|0)%4;this.iTurnLeft=(this.iForward+3|0)%4;this.collider.addOnCollision(Bridge.fn.cacheBind(this,this.OnCollision));this.sprite.SetSortOrder(.74);this.decal=new CircuitCracker.Sprite.ctor(CircuitCracker.Sprites.RobotDecal.$clone(),placedOn.pos.$clone(),placedOn.objFacing,.74);this.decal.color=CircuitCracker.LevelRenderer.colors[placedOn.GetObjectColor()].$clone();this.baseSprite=new CircuitCracker.Sprite.ctor(CircuitCracker.Sprites.RobotBase.$clone(),placedOn.pos.$clone(),placedOn.objFacing,1)}},methods:{Destroy:function(){this.baseSprite.Remove();this.decal.Remove();CircuitCracker.LevelObjects.Moveable.prototype.Destroy.call(this)},SetTransform$1:function(position,rotation){this.decal.position=position.$clone();this.decal.rotation=rotation;CircuitCracker.LevelObjects.Moveable.prototype.SetTransform$1.call(this,position.$clone(),rotation)},Reset:function(){this.canWalk=!0;this.decal.SetEnabled(!0);this.lookDir=this.FacingDirection();CircuitCracker.LevelObjects.Moveable.prototype.Reset.call(this)},FixedUpdate:function(){var $t,$t1,$t2,$t3,$t4,$t5,rotate,layer,active,active1,active2,sensor;if(CircuitCracker.LevelObjects.Moveable.prototype.FixedUpdate.call(this),this.decal.position=this.sprite.position.$clone(),this.decal.rotation=this.sprite.rotation,this.canWalk){rotate=0;layer=this.placedOn.GetWireLayer(this.iTurnRight);layer>=0&&(active=($t=this.placedOn.signalStrength)[layer]>0,active&&!this.lastTurnRight&&(rotate=rotate+1|0),this.lastTurnRight=active);layer=this.placedOn.GetWireLayer(this.iTurnAround);layer>=0&&(active1=($t1=this.placedOn.signalStrength)[layer]>0,active1&&!this.lastTurnAround&&(rotate=rotate+2|0),this.lastTurnAround=active1);layer=this.placedOn.GetWireLayer(this.iTurnLeft);layer>=0&&(active2=($t2=this.placedOn.signalStrength)[layer]>0,active2&&!this.lastTurnLeft&&(rotate=rotate+3|0),this.lastTurnLeft=active2);rotate!==0&&(this.lookDir=Microsoft.Xna.Framework.Vector2.Transform(this.lookDir.$clone(),Microsoft.Xna.Framework.Matrix.CreateRotationZ(rotate*CircuitCracker.LevelObjects.LevelObject.facing2rad)),this.lookDir.Normalize(),this.sprite.rotation=Math.acos(-this.lookDir.Y)*(this.lookDir.X<0?-1:1));layer=this.placedOn.GetWireLayer(this.iForward);layer>=0&&($t3=this.placedOn.signalStrength)[layer]>0?(this.collider.LinearVelocity=Microsoft.Xna.Framework.Vector2.op_Addition(this.collider.LinearVelocity.$clone(),Microsoft.Xna.Framework.Vector2.op_Multiply$1(this.lookDir.$clone(),CircuitCracker.LevelObjects.Robot.speed)),this.collider.LinearDamping=37):this.collider.LinearDamping=25;this.hitFixture=null;CircuitCracker.Game.world.RayCast$1(Bridge.fn.cacheBind(this,this.RayCastCallback),this.collider.Position.$clone(),Microsoft.Xna.Framework.Vector2.op_Addition(this.collider.Position.$clone(),Microsoft.Xna.Framework.Vector2.op_Multiply$1(this.lookDir.$clone(),.65)));$t4=Bridge.getEnumerator(CircuitCracker.LevelObjects.RobotSensor.robotSensors[this.placedOn.GetObjectColor()]);try{while($t4.moveNext())sensor=$t4.Current,Bridge.referenceEquals(($t5=sensor.GetSensorFixture())!=null?Bridge.getType($t5.Body.UserData):null,this.hitFixture!=null?Bridge.getType(this.hitFixture.Body.UserData):null)&&sensor.SetActive()}finally{Bridge.is($t4,System.IDisposable)&&$t4.System$IDisposable$Dispose()}}},Damage:function(){this.canWalk=!1;this.decal.SetEnabled(!1);this.Dissolve(.25)},LaserHit:function(){this.Damage()},TeleportAdd:function(){this.canWalk=!1;this.decal.SetEnabled(!1);this.Materialize(.25,Bridge.fn.bind(this,function(){this.canWalk=!0;this.decal.SetEnabled(!0)}))},TeleportRemove:function(){this.canWalk=!1;this.decal.SetEnabled(!1);this.Teleport(.25)},OnCollision:function(fixtureA,fixtureB,contact){var player;(player=Bridge.as(fixtureB.Body.UserData,CircuitCracker.LevelObjects.Player))!=null&&player.Damage()},RayCastCallback:function(fixture,point,normal,fraction){return fixture.IsSensor?-1:(this.hitFixture=fixture,fraction)}}});Bridge.define("CircuitCracker.UI.TextBox",{inherits:[CircuitCracker.UI.Panel],statics:{fields:{fontSmall:null,fontBig:null}},fields:{font:null,textColor:null,padding:null,textSize:null,text:null},ctors:{init:function(){this.textColor=new Microsoft.Xna.Framework.Color;this.padding=new CircuitCracker.UI.Thickness;this.textSize=new Microsoft.Xna.Framework.Point;this.textColor=Microsoft.Xna.Framework.Color.White.$clone()},$ctor1:function(text,heading){heading===void 0&&(heading=!1);CircuitCracker.UI.TextBox.ctor.call(this,text,Microsoft.Xna.Framework.Color.White,heading)},ctor:function(text,textColor,heading){heading===void 0&&(heading=!1);this.$initialize();CircuitCracker.UI.Panel.ctor.call(this);this.textColor=textColor.$clone();this.text=text;this.SetText(text,heading)}},methods:{Width:function(){return this.textSize.X+this.padding.Width|0},Height:function(){return this.textSize.Y+this.padding.Height|0},SetText:function(text,heading){heading===void 0&&(heading=!1);this.text=text;this.font=heading?CircuitCracker.UI.TextBox.fontBig:CircuitCracker.UI.TextBox.fontSmall;this.padding=heading?new CircuitCracker.UI.Thickness.$ctor3(12,16,8,16):new CircuitCracker.UI.Thickness.$ctor3(4,8,0,8);text!=null&&(this.textSize=this.font.MeasureString(text).ToPoint())},Render:function(spriteBatch,tex){CircuitCracker.UI.Panel.prototype.Render.call(this,spriteBatch,tex);this.text!=null&&spriteBatch.DrawString(this.font,this.text,new Microsoft.Xna.Framework.Vector2.$ctor2(this.rect.X+this.padding.Left|0,this.rect.Y+this.padding.Top|0),this.textColor.$clone())}}});Bridge.define("CircuitCracker.UI.Image",{inherits:[CircuitCracker.UI.Panel],fields:{texture:null,sourceRect:null,color:null},ctors:{init:function(){this.sourceRect=new Microsoft.Xna.Framework.Rectangle;this.color=new Microsoft.Xna.Framework.Color},ctor:function(texture,color){CircuitCracker.UI.Image.$ctor1.call(this,texture,texture.Bounds,color)},$ctor1:function(texture,sourceRect,color){this.$initialize();CircuitCracker.UI.Panel.ctor.call(this);this.SetImage(texture,sourceRect.$clone(),color.$clone())},$ctor2:function(sourceRect,color){this.$initialize();CircuitCracker.UI.Panel.ctor.call(this);this.SetImage$1(sourceRect.$clone(),color.$clone())}},methods:{SetImage:function(texture,sourceRect,color){this.texture=texture;this.SetImage$1(sourceRect.$clone(),color.$clone())},SetImage$1:function(sourceRect,color){this.sourceRect=sourceRect.$clone();this.color=color.$clone()},Width:function(){return this.texture!=null?this.texture.Width:this.sourceRect.Width},Height:function(){return this.texture!=null?this.texture.Height:this.sourceRect.Height},Render:function(spriteBatch,tex){CircuitCracker.UI.Panel.prototype.Render.call(this,spriteBatch,tex);this.texture!=null?spriteBatch.Draw$1(this.texture,new Microsoft.Xna.Framework.Rectangle.$ctor1(this.rect.Location.$clone(),this.texture.Bounds.Size.$clone()),this.sourceRect.$clone(),this.color.$clone()):spriteBatch.Draw$1(tex,this.rect.$clone(),this.sourceRect.$clone(),this.color.$clone())}}});Bridge.define("CircuitCracker.UI.Slider",{inherits:[CircuitCracker.UI.Panel,CircuitCracker.UI.ISelectable],fields:{padding:0,paddingHovered:0,callback:null,percent:0,hovered:!1},alias:["PointerEnter","CircuitCracker$UI$ISelectable$PointerEnter","PointerExit","CircuitCracker$UI$ISelectable$PointerExit","PointerDown","CircuitCracker$UI$ISelectable$PointerDown","PointerUp","CircuitCracker$UI$ISelectable$PointerUp","Select","CircuitCracker$UI$ISelectable$Select","Drag","CircuitCracker$UI$ISelectable$Drag"],ctors:{init:function(){this.padding=8;this.paddingHovered=4},$ctor1:function(callback,width,value){value===void 0&&(value=0);CircuitCracker.UI.Slider.ctor.call(this,callback,width,25,value)},ctor:function(callback,width,height,value){value===void 0&&(value=0);this.$initialize();CircuitCracker.UI.Panel.$ctor2.call(this,width,height);this.percent=CircuitCracker.Utilities.Clamp$1(value,0,1);this.SetCallback(callback)}},methods:{SetCallback:function(callback){this.callback=callback},SetValue:function(value,callback){callback===void 0&&(callback=!1);this.percent=CircuitCracker.Utilities.Clamp$1(value,0,1);callback&&!Bridge.staticEquals(this.callback,null)&&this.callback(this.percent)},PointerEnter:function(){this.ShowBorder(new CircuitCracker.UI.Thickness.$ctor1(2),Microsoft.Xna.Framework.Color.White.$clone());this.hovered=!0},PointerExit:function(){this.HideBorder();this.hovered=!1},PointerDown:function(){this.ShowBorder(new CircuitCracker.UI.Thickness.$ctor3(2,1,1,2),Microsoft.Xna.Framework.Color.White.$clone());this.position=Microsoft.Xna.Framework.Point.op_Addition(this.position.$clone(),new Microsoft.Xna.Framework.Point.$ctor2(1,1))},PointerUp:function(){this.ShowBorder(new CircuitCracker.UI.Thickness.$ctor1(2),Microsoft.Xna.Framework.Color.White.$clone());this.position=Microsoft.Xna.Framework.Point.op_Subtraction(this.position.$clone(),new Microsoft.Xna.Framework.Point.$ctor2(1,1))},Select:function(){},Drag:function(){var x=(CircuitCracker.Input.GetMousePosition().X-this.rect.X|0)-this.paddingHovered|0,percent=x/(this.rect.Width-Bridge.Int.mul(2,this.paddingHovered)|0);this.SetValue(percent,!0)},Render:function(spriteBatch,tex){CircuitCracker.UI.Panel.prototype.Render.call(this,spriteBatch,tex);var pad=this.hovered?this.paddingHovered:this.padding,pos=new Microsoft.Xna.Framework.Point.$ctor2(this.rect.X+pad|0,this.rect.Y+pad|0),width=this.rect.Width-Bridge.Int.mul(pad,2)|0,height=this.rect.Height-Bridge.Int.mul(pad,2)|0;spriteBatch.Draw$1(tex,new Microsoft.Xna.Framework.Rectangle.$ctor1(pos.$clone(),new Microsoft.Xna.Framework.Point.$ctor2(width,height)),CircuitCracker.Sprites.HalfBox.$clone(),Microsoft.Xna.Framework.Color.DimGray.$clone());spriteBatch.Draw$1(tex,new Microsoft.Xna.Framework.Rectangle.$ctor1(pos.$clone(),new Microsoft.Xna.Framework.Point.$ctor2(Bridge.Int.clip32(this.percent*width),height)),CircuitCracker.Sprites.HalfBox.$clone(),Microsoft.Xna.Framework.Color.White.$clone())}}});Bridge.define("CircuitCracker.LevelObjects.InversePlayer",{inherits:[CircuitCracker.LevelObjects.PlayerBase],ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.PlayerBase.ctor.call(this,placedOn,id,-1);this.defaultShader=CircuitCracker.Shader.Invert;this.sprite.effects=3;this.sprite.SetShader(CircuitCracker.Shader.Invert)}}});Bridge.define("CircuitCracker.LevelObjects.Player",{inherits:[CircuitCracker.LevelObjects.PlayerBase],ctors:{ctor:function(placedOn,id){this.$initialize();CircuitCracker.LevelObjects.PlayerBase.ctor.call(this,placedOn,id,1)}}});Bridge.define("CircuitCracker.UI.Button",{inherits:[CircuitCracker.UI.TextBox,CircuitCracker.UI.ISelectable],fields:{callback:null,animate:!1},alias:["Select","CircuitCracker$UI$ISelectable$Select","PointerEnter","CircuitCracker$UI$ISelectable$PointerEnter","PointerExit","CircuitCracker$UI$ISelectable$PointerExit","PointerDown","CircuitCracker$UI$ISelectable$PointerDown","PointerUp","CircuitCracker$UI$ISelectable$PointerUp","Drag","CircuitCracker$UI$ISelectable$Drag"],ctors:{init:function(){this.animate=!0},ctor:function(text,callback){this.$initialize();CircuitCracker.UI.TextBox.$ctor1.call(this,text,!1);this.SetCallback(callback)}},methods:{SetCallback:function(callback){this.callback=callback},SetAnimation:function(active){this.animate=active},Select:function(){Bridge.staticEquals(this.callback,null)?null:this.callback()},PointerEnter:function(){this.animate&&this.ShowBorder(new CircuitCracker.UI.Thickness.$ctor1(2),Microsoft.Xna.Framework.Color.White.$clone())},PointerExit:function(){this.HideBorder()},PointerDown:function(){this.animate&&(this.ShowBorder(new CircuitCracker.UI.Thickness.$ctor3(2,1,1,2),Microsoft.Xna.Framework.Color.White.$clone()),this.position=Microsoft.Xna.Framework.Point.op_Addition(this.position.$clone(),new Microsoft.Xna.Framework.Point.$ctor2(1,1)))},PointerUp:function(){this.animate&&(this.ShowBorder(new CircuitCracker.UI.Thickness.$ctor1(2),Microsoft.Xna.Framework.Color.White.$clone()),this.position=Microsoft.Xna.Framework.Point.op_Subtraction(this.position.$clone(),new Microsoft.Xna.Framework.Point.$ctor2(1,1)))},Drag:function(){}}});Bridge.define("CircuitCracker.UI.Dropdown",{inherits:[CircuitCracker.UI.Button],fields:{menu:null,blocker:null,callback$1:null,options:null,current:0},alias:["Select","CircuitCracker$UI$ISelectable$Select"],ctors:{ctor:function(options,selected,callback){selected===void 0&&(selected=0);callback===void 0&&(callback=null);this.$initialize();CircuitCracker.UI.Button.ctor.call(this,"",null);this.blocker=CircuitCracker.UI.UIBuilder.Anchors(Bridge.global.CircuitCracker.UI.Button,new CircuitCracker.UI.Button("",Bridge.fn.cacheBind(this,this.Hide)),CircuitCracker.UI.AnchorX.Stretch,CircuitCracker.UI.AnchorY.Stretch);this.blocker.SetBackgroundColor(Microsoft.Xna.Framework.Color.op_Multiply(Microsoft.Xna.Framework.Color.Black.$clone(),.5));this.blocker.SetAnimation(!1);this.SetCallback$1(callback);this.SetOptions(options,selected)}},methods:{SetOptions:function(options,selected){var menuItems,i,x;for(selected===void 0&&(selected=0),this.options=options,this.current=CircuitCracker.Utilities.Clamp(selected,0,options.length),menuItems=System.Array.init(options.length,null,CircuitCracker.UI.Button),i=0;i<menuItems.length;i=i+1|0)x={v:i},menuItems[i]=new CircuitCracker.UI.Button(options[i],function($me,x){return Bridge.fn.bind($me,function(){this.SetValue(x.v,!0)})}(this,x)),menuItems[i].SetAnchors(CircuitCracker.UI.AnchorX.Stretch,CircuitCracker.UI.AnchorY.Top);this.menu=new CircuitCracker.UI.VerticalLayout(2,menuItems);this.menu.SetParent(this.blocker);this.SetValue(this.current)},SetCallback$1:function(callback){this.callback$1=callback},SetValue:function(value,callback){callback===void 0&&(callback=!1);this.current=CircuitCracker.Utilities.Clamp(value,0,this.options.length);callback&&!Bridge.staticEquals(this.callback$1,null)&&this.callback$1(this.current);this.SetText(this.options[this.current]);this.Hide()},Select:function(){this.menu.SetPosition(new Microsoft.Xna.Framework.Point.$ctor2(this.rect.X-1|0,(this.rect.Y+this.Height()|0)+1|0));this.blocker.SetVisible(!0);this.blocker.SetParent(null)},Hide:function(){this.blocker.SetVisible(!1)}}});Bridge.define("CircuitCracker.UI.ToggleButton",{inherits:[CircuitCracker.UI.Button],fields:{callback$1:null,on:null,off:null,state:!1},alias:["Select","CircuitCracker$UI$ISelectable$Select"],ctors:{$ctor1:function(on,off,initialValue,callback){this.$initialize();CircuitCracker.UI.Button.ctor.call(this,initialValue?on:off,null);this.off=off;this.on=on;this.state=initialValue;this.SetCallback$1(callback)},ctor:function(on,off,callback){CircuitCracker.UI.ToggleButton.$ctor1.call(this,on,off,!1,callback)}},methods:{SetCallback$1:function(callback){this.callback$1=callback},Select:function(){CircuitCracker.UI.Button.prototype.Select.call(this);this.state=!this.state;this.SetText(this.state?this.on:this.off);Bridge.staticEquals(this.callback$1,null)?null:this.callback$1(this.state)}}})});